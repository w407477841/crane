package com.xywg.equipment.monitor.modular.whf.handler;

import cn.hutool.core.date.DateUtil;
import cn.hutool.core.util.CharsetUtil;
import cn.hutool.core.util.HexUtil;
import cn.hutool.core.util.RandomUtil;
import cn.hutool.core.util.StrUtil;
import cn.hutool.json.JSONUtil;
import com.xywg.equipment.monitor.config.ZbusProducerHolder;
import com.xywg.equipment.monitor.config.properties.FTPProperties;
import com.xywg.equipment.monitor.core.util.DataUtil;
import com.xywg.equipment.monitor.core.util.RedisUtil;
import com.xywg.equipment.monitor.modular.whf.dto.UserInfoDTO;
import com.xywg.equipment.monitor.modular.whf.util.FileUploadToFTP;
import io.netty.buffer.ByteBuf;
import io.netty.buffer.Unpooled;
import io.netty.channel.Channel;
import io.netty.channel.ChannelHandler;
import io.netty.channel.ChannelHandlerContext;
import io.netty.channel.SimpleChannelInboundHandler;
import io.netty.handler.timeout.IdleState;
import io.netty.handler.timeout.IdleStateEvent;
import io.netty.util.AttributeKey;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import java.io.*;
import java.math.BigDecimal;
import java.math.BigInteger;
import java.util.Date;
import java.util.Map;
import java.util.concurrent.ConcurrentHashMap;

/**
 * @author : wangyifei
 * Description
 * Date: Created in 11:17 2019/1/7
 * Modified By : wangyifei
 * 00000000
 * 左侧是高位，右侧是低位，bit7  bit6  bit5  bit4  bit3 bit2 bit1 bit0
 */
@Component
@ChannelHandler.Sharable
@SuppressWarnings("all")
public class NettyHandler extends SimpleChannelInboundHandler<ByteBuf> {

    private static final Logger LOGGER = LoggerFactory.getLogger(NettyHandler.class);

    private static final String HEADER = "A55A";
    private static final String FOOTER = "CC33C33C";

   @Autowired
   private FTPProperties ftpProperties;

   @Autowired
   FileUploadToFTP fileUploadToFTP;


    @Autowired
    ZbusProducerHolder zbusProducerHolder;
    @Autowired
    RedisUtil redisUtil;


    /**
     * 绑定通道
     */
    private static final AttributeKey<XySession> NETTY_CHANNEL_KEY = AttributeKey.valueOf("netty.channel");

    /**
     * 本地通道缓存
     */
    public static Map<String, Channel> nettyChannels = new ConcurrentHashMap<>(10);

    @Override
    protected void channelRead0(ChannelHandlerContext ctx, ByteBuf msg) throws Exception {

        ByteBuf buf = (ByteBuf) msg;
        //可读长度
        int readableLength = buf.readableBytes();
        byte[] msgData = new byte[readableLength];
        buf.readBytes(msgData);
        String originalData = DataUtil.bytesToHexString(msgData).toUpperCase();
        originalData = originalData.substring(originalData.indexOf(HEADER));
        System.out.println(originalData);
        //数据合法性检查
        if (!valid(originalData)) {
            throw new RuntimeException("非法数据 <" + originalData + ">");
        }
        sendTest(originalData);
        //类型
        String type = this.type(originalData);
        switch (type) {
            // 注册
            case "01":
                this.zhuce(originalData, ctx);
                break;
            //基本信息
            case "03":
                //   this.jibenxinxi(originalData,ctx);
                break;
            // 人员身份认证信息
            case "12":
                this.renyuanxinxi(originalData, ctx);
                break;
            //传感器
            case "33":
                break;
            // 报警设置信息
            case "35":
                break;
            // 限位设置信息
            case "37":
                break;
            // 障碍物信息
            case "2F":
                break;
            case "10":
                this.shishishuju(originalData, ctx);
                break;
            case "11":
                this.baojingshuju(originalData, ctx);
                break;
            //上传图像
            case "20":
                this.imageInfo(originalData, ctx);
                break;


        }


    }

    /**
     * 组装人员信息
     *
     * @param ctx
     * @return
     */
    private String userinfo(ChannelHandlerContext ctx) {
        //获取当前通道session
        StringBuffer stringBuffer = new StringBuffer("");
        XySession currSession = ctx.channel().attr(NETTY_CHANNEL_KEY).get();
        String key = "device_platform:userinfo:lift:" + sn(currSession.getNumber(), currSession.getSn(), currSession.getCj());
        if (redisUtil.exists(key)) {
            String json = (String) redisUtil.get(key);
            UserInfoDTO userInfoDTO = JSONUtil.toBean(json, UserInfoDTO.class);
            if (userInfoDTO.getUsername() != null && userInfoDTO.getUsername().trim().length() > 0) {
                stringBuffer.append("key1:").append(userInfoDTO.getUsername().trim()).append(",");
            }
            if (userInfoDTO.getUserId() != null && userInfoDTO.getUserId().trim().length() > 0) {
                stringBuffer.append("key2:").append(userInfoDTO.getUserId().trim()).append(",");
            }
            if (userInfoDTO.getIdCard() != null && userInfoDTO.getIdCard().trim().length() > 0) {
                stringBuffer.append("key3:").append(userInfoDTO.getIdCard().trim()).append(",");
            }

        }
        return stringBuffer.toString();
    }

    /**
     * 处理人员信息
     *
     * @param data
     * @param ctx
     */
    private void renyuanxinxi(String data, ChannelHandlerContext ctx) {
//        if(!isLogin(ctx)){
//            throw  new RuntimeException("未登录");
//        }
        //获取内容
        String content = this.content(data);
        // 0-2 识别结果状态值
        // 2-66 用户名
        // 66-82 用户id
        // 82-84 百分比
        // 84-118 身份证
        String status = StrUtil.sub(content, 0, 2);
        String number = this.number(data);
        String sn = this.sn(data);
        String cj = this.content(data);
        String deviceno = sn(number, sn, cj);
        if ("00".equals(status)) {
            //认证失败
            LOGGER.info("指纹{}", deviceno);
        } else {

            // 认证通过
            LOGGER.info("人脸{}", deviceno);
        }
        String usernameHex = StrUtil.sub(content, 2, 66);
        String username = HexUtil.decodeHexStr(usernameHex, CharsetUtil.CHARSET_GBK);
        String useridHex = StrUtil.sub(content, 66, 82);
        String userid = HexUtil.decodeHexStr(useridHex);
        String accuracyHex = StrUtil.sub(content, 82, 84);
        Integer accuracy = Integer.parseInt(accuracyHex, 16);
        String idcardHex = StrUtil.sub(content, 84, 118);
        String idcard = HexUtil.decodeHexStr(idcardHex);

        UserInfoDTO userInfoDTO = new UserInfoDTO(username, userid, idcard, accuracy);


        String key = "device_platform:userinfo:lift:" + deviceno;
        redisUtil.set(key, JSONUtil.toJsonStr(userInfoDTO), 60 * 6L);


    }

    /**
     * 数据长度
     *
     * @param data
     * @return
     */
    public static String length(String data) {
        int s = data.length() / 2;
        String length = Integer.toHexString(s);
        length = StrUtil.fillBefore(length, '0', 2);
        return length;
    }

    /**
     * 图像处理
     *
     * @param data
     * @param ctx
     */
    private void imageInfo(String data, ChannelHandlerContext ctx) {
        //A5 5A 20 00 C6 65 75 头部
        if (!isLogin(ctx)) {
            throw new RuntimeException("未登录");
        }

//测试用
//        String end1="FFD8FFDB0043000A06070807060A0808080B0A0A0B0F19100F0D0D0F1E15171219241F2625231F2322282D3930282A362B2223324432363B3D4041402630464B463E4B393F403DFFDB0043010A0B0B0F0D0F1D10101D3D2923293D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3D3DFFC000110801E0028003012100021101031101FFC4001F0000010501010101010100000000000000000102030405060708090A0BFFC4001F0100030101010101010101010000000000000102030405060708090A0BFFC400B5100002010303020403050504040000017D01020300041105122131410613516107227114328191A1082342B1C11552D1F02433627282090A161718191A25262728292A3435363738393A434445464748494A535455565758595A636465666768696A737475767778797A838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE1E2E3E4E5E6E7E8E9EAF1F2F3F4F5F6F7F8F9FAFFC400B51100020102040403040705040400010277000102031104052131061241510761711322328108144291A1B1C109233352F0156272D10A162434E125F11718191A262728292A35363738393A434445464748494A535455565758595A636465666768696A737475767778797A82838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE2E3E4E5E6E7E8E9EAF2F3F4F5F6F7F8F9FAFFDA000C03010002110311003F00EA8D34D330571845348A450DA42281D869C5348A690C69A4A571DC4A422818DC521140DEBA22196DE19548922470473B866B2DEC164BA315A3340B8F9C2310BF88AA4C5AD8559F50D3C04B8816789780D07181EF9AB769A95B5DF1148011D55B20FEA2A5ABEC55EC8B34628B0EE25252420C526295D9418A4C5025BEA2629314986C2629314C77D3513146290D682523108BB98E00EA686EC84CA96C86EE41772E760FF5687F9D5CC51B6811131498A683C9852549418CD2631458000A4C555C120C52633482C4AA046BB8D44EDB8D1D4A5A0DE2933409D9899A63B7A503D2C66EACEC1238F2406249FE959E734450DBD340EBC1A58D774A83FDA157D3425C9EE3AE5B7CF21EB9626A3ED427A587757B89529E2D97D4B9CFD31436272D48B18A3152857B12C636C4E477E29D1A000332EE6278523A55BEE0EF62F465B6007EF1A99408464F2C78A8D12B93D05442EDB8D5A4000A77EC27A8FDA1860F43502E6DA5E7FD5B1E31DA9E82B17A3E79AB7A7D8DCEAB7C9A7D992AEDF3492E32224EE7EBE82AA2AECCE4ECAE7A568DA4D968B62B6763088E3072C7AB3B1EACC7B93EB576B36DB7765423CB14828A450514015F50BD874FB392EAE1F6C718C9F7F403DEBCEAFEFAE351BA7BCBAC86931B63CE4228E807E759D94A7E837A44D134D35D3D4E7D861A69A92869A434C77184D251D006D21A3A0FA094D2690C434868432B5F5C7949B57EFBF0A053AD2DFECD0ED272E7963EF4D3B5C44BD2A9DEE9B6978774D0A971D1C75146C36B42AFD9B52B2FF8F5B8171103FEAA6E4FD01E29F0EAF0EE11DCC725AC9FDD90707F11C517B8F62F06561904107D0D15234EE14948ADC292AB4109452012928BDC425152310FBD53606FA7D99FF468CFCC7FBE7D28EA0DE9A170F273D292818525017128A4025145C61453B02627D681490D093BF4A877517284DD49BA8244DD5117F988346A2DC82F2D7ED3B583ED651C71C566CB149131574231DF1C1AA4D447B2199CF352DB63CF57FEE82DFA53D86DEA45CF141F5A9BE827BD9083AD492F0912F70833F5AAD191623ED40E9545B7D0B0A523813775625957D7A5588A32ADB9B973C75A96F5B19F52DA010AE4FDF348A0BB668715D06EC958B28A00A78A2F60E961E294A8752A475A7616E44924906205DBBD995222E4EDC93819F6CD7ABF86B438B42B0F2449E74F21DD34C460BB7F403B0ABF69CB169753271BC8D5A2B1340A2800A6BB2A217760AAA3249E80526ECAEC0E03C41AC7F6D5D064626CA26CC2BD9CFF007FFC2B2A46C9A9A51E55EA15757A74364D34D745AECE75B8C6A6D2652D46D21348761BD69B4CADC4A4A43B0869940210D365711A1663802828A967199E4FB5CA3FEB9AFB7AD5CA2C095C4A4A2E09E834D32789268CC72A8910F1B5B915372AF6287F657D9CEED3E76B6FFA66794FCA9BFDA53DA71A85";
//        String end2="B90BFF003D62195FC475AADD589F32EC1710DC2078645753D314F15362AE985140BA89450C2F777109A2905C6D250172ADC3BCF30B588F1FF2D5BFBA2AC471A451AC71AED441800509E850EA4A016A80D25213129282828A630A4A4D801A4A770DC649CD424115255F4129314C9B914F2F96768196F4A812E817D93AF96C7A1C707FC296E16D0B0095F7143A24ABB5D430F43543BE867DD5918B2F1FCC9DC771515B8C2CCFE8800FC4D545AB5849DED722E7BD153256D4371172580F7C53E7FF005AC01E01C552D876B2B319826A4402351239C7F754FF0011AAB89349EA4F0420B09E65CC879507B7E1579008C6F7E58F6A8F845D751BCBB673D6AC469B4555ECAE27BDC905387349896A3852E715490849AD92E6168E519DDFA5773F0F3C40D716C347BF949BBB650237618F3531DBD48C73F51474B19B496ACEC28ACCB0A2800AE2FC5DADFDB647D3AD9F36E8713329FBE7FBB9F4F5FF0039CAA2726A25C1B8A725FD5CE79DEA266AD9996E8DD34D35A18A5A5D8C34CA4521A690D35A1771B494816A3690D0C6D0D34940F610F02A84DBAF6E0DBA9C4684173496E2BE85EE070A30074149414B41292804C29B486251920633D681EC509F48B5790CD129B7989CF9911DA6A3326A5667F78A2F63FEF20DAC3EB93CD17EE45AECB169A8DADD9222946E1D5181047E75632292B8D05146AC62521A43E512ABDE4E63C4517CD349C281FCE906C3EDE05B78F629DC49CB31EAC7D6A4A7D461494804A0D16B0F66251405C4A29A1D828A42129281A11B03935590C9348CEB8110E067A93496AC7D0730A8E432046F29C24983B588CE0D3B023234D945B20B3BD998DD962DB9F277E71D0D684910705587E14E4D0B5B95D5A4B5C01B9E21FC39E45598E459103C6D90685AEA1B1206CF7AAD756E1A3731AE19BD3BF3482E67639C11823B1A0D52F30D8740B99547BF34CCEFF9BD79A7A8F644B04065249FBA3AFBD4B1C45DBCC997A7DC42385A6C865D44D837B8F9BD3D29B9673CD45ADA315B42C469814FAAB8F6169F4AE407414A9C9DC6A96A04CA694ABACB15CDBBF977103078E41D41FF00F5517B1373D2BC27AFC7AFE969311E5DD4602DC44460ABE39C0C9E0F6AD9A992B304EE145228E63C5DAFB400E9D6526266FF005B229FF56BE83DCFE95C782B1461106157802B3A3795E6CA968AC46CD51935BDAC667446986A99921869B4B71A1A69A6818D3486828434D3458AD2E34D14856EA55BF9CC71EC4E5DF85A7DAC02DE1D9C163CB37A9A6B6192D2521A57109A4A409D84A4A4F60F30A4A10C434503EA56BDD3ED6FB06E215675FBB27F12FD0D5436DA8D9736D75F698873E54C39FC0D0993B8F8757859FCAB88DEDA5FEEC9D3F3E957B702010473EF43F22934B403454EA16EA43753ADBC464233D80F534CB381A3CCD31DD3C9D4FF00747A552EA12EC4F4952160A4A1157D04A280B5C4A295804A29EC170A2818947149822ABFFA5398D491129F998773E82A7C050028C01C014FA00C619A8CAFAD0BCC657BCB486EE2F2EE22122F6CF6FA567B35E694A37B35EDA0FC5E31F53D695C35B1723921B98BCD82412479FBC38FCEA0689E272F030427A8ECD4EF61B77893417093E40051C7543DAA6069324AD796C24FDE0CEFFE7541948241E083822AD0D34C7C1C798DFDD5FE74471B4ADB57F13E94D68C77B22F8548970A303B0A7C6800F31CE3D0517BEA4584DC646A9E34C0A9448F1C52D0316949C734EE35AE822FCC73DAA506857207A9A914D558926D3750B8D0F534D4AD46E0485B8880FF00589CFD3919C8AF53D3AFADB52B28AF2D2412432A8653D3F31D8D124ED716CCB3585E2AF100D2A116F6F87BD987CA3B20FEF1FE83BD73D5959596ECD611BBBF63846918E59DCBBB1CB3B7563EB5197AD92E55A10DDDDC8C9A69346E4BEC7484D34D6864863530D2E85210D3296C3F31A690D31F9894D3487E625325711A166E8051702AFA01D8A19A437926727841EDEB56E87A681E425250CAD8293A521DC434940B7128A5D4B128A180949498865C4115D4462B8412A1FE16E4567FF65CD6B93A65D3403FE78B9CA7E1E94D30620D55AD8ECD42DDE13D3CC032A4FE19ABE2789A232AC8AC98CE41A4FC84416A867905DCBD3FE5927A7BD59343D86B70A4A43DC4A2905BA09494C6828A43425140051D28402557959A67F22238EEED9E83DA8DF40265558D0220C28E829281DAC84229A4500C632E29BC8E54E0D204655CE9AF0C8F75A6BFD9E76FBD1F5493D78F5A92DAF21BB778C7EEE74CEF85F8239EDEA29DAFB072F509A1DFF329DAE3956F4A7C339918C7280245EA4701BE949312491383EB556F6DF3B";
//        String end3="A54033D587AD506DB15E3563136149DC7156E28D6DD3DCF5355606BB8F8C6EFDE3F41D282CD2B74C7A50D0ADA5C9E24C0A928D04D682D1490741734DE5FE9549750B12034EA56B885069EA6811206AD1F07EBE7C397FF00649B1FD9B74E0703FD43F3C8C763C67E9577E8434D6C777E24D7A1D16C83E43DC4BC4518FE23EBF4AF3B9AE65B89A4B9B8937CD29DCCDFD2B962B9AA3976D0D768AF3222F4C2D5D288484CD21348474C6986AF732BDC69A6D218D34C340C434DA431334D34C7D069AA33EEBCB916EBF7179734ADA86C5DE070381D85140EC2525205A8949F5A4C760A4A602521A9185068EA34EE25140C4A4A07D046C32146E54F507A5638D2A19EE256B3C5B22F52BF759B3E9427664DCB06F6F2D0817B6FE6C63FE5B423007E1926AD5BDCC172BBA1955BD47423F034B6D82D624CD145C77D04A4C522760A282C4A29805252630A43430219A562E218B990F527A28F5A7C51AC29B173EE4F53F5A4985C753699570A4A4D8084669A56989EE44EB9E0D52D4B4F4BD0AE58A4E83F77282723DA81DEDB15ED6FA4F3CDA6A004777C90DC05907B7BD4F3C21F86CAB29E1BBA9A4FDED5095EE259CCF33490C9F34B08059BB367BD4F9EC6ABCC1EE200AA38007D2A39D4C8060E3041A02FDC9598CA7818152C718514EDD444829690930A3A53EA2B0DC963C74A78E07155B0C70347E346C4DAE3A941A1D909AD47034DB8559632AE0107B1A03622B3DB1011B67720C2E7B0F41E82AD6FA6C9B5C3752134BA8D099A696A1BEA4F5B9D51A63559921A698690C69A6D0310D34D056E253690D15AFAE3C98C01F798E171EB4B676FF67802B1CB9E5CFA9A13D0096928D869EA149487A01A69EB4AD61F98948698905153B8D0945034251484C4A2802ADC3B4D27D9A22467EFB0FE1153A22C48B1C6308A30050B618B923A552B8D2ED667F3554C137FCF488ED3FF00D7A3CC089A5D4ACFFD6A7DBA3FEFA70E3F33CD4F6BA85B5DF11BED6FEE3FCADFAD00B42C5148ADD0945226C2514CAD828A43425437337960220DD23F0AA3F9D36C4B4D47411792A72DB9DB976F53FE14E34DBD476128A43D84229290F70A43409B1AC322A365A1936D0A7A859457B079538240FBA47553ED50582DD80F05DE6431F2B3E7EF8F7F7AA8F60D7734049E5C3E52F03A903B9A85B9A0A13151CCB36CFDC20761D8F7A9168F726B299264E01571F791872B562AC360A5A42E9A0669AC771DA29A15D8E031C52D3DD0F6D4334A28DC97DC01A766843605B033429CF26A96A4BEC3675C8DEBF787EB4E86612A67BF71E94584F71F9A09A7B0085B029074C9A9DD81D69A61156F531430D34D2631A698686021A6D2188698EC1412C70050CA5DCA568A6E66374F9DA0FEEC1FE75728E8342525204AE82929751A42526687A03614940798948690C2928296C145262B09505D4CD1A848866573851E9EF496A3E83ADE016F1EC072C7966F53525364AD84A4A431391C838AAF79636D79F34F1E5C1C89070C3F1A07E85631EA365FEAA417900FE07FF583E872054B6FA95BCEFE59DF0C8382928C7EBD29B6986C5AA29030A4A57185274A06473CC214DC792780A3B9A6DB42D1664970676186239C0F4140897DE92849A2AE252E29A6170C1A89980350D8D2D003034B542B0869A4500C8E401465BA544C31C8E94EC1B2194669A571DC5552C71561230A285A10437368B2BF9AAC639BB48BDFEBEB4C82E983882E808E6FD1BDC5329BBA2D525210D273C0EB4E51818AA4C57D45A2800A5A4985F40A338E69DC2F760393934F1C53B92FB81355E4FDC3EF07E563C8F7F5A2CD0B5B1615B70C8A09C53056EA0BEA69734992CEBD85308AD5995EC318530D48EE34D30D485AE34D34D0310D51BC669E716D19F763E828EA5742D2AAA28551851C01450D896821CD2522D6821A29009494075129281AD42929751EC1494B70D2C19A43420BD911CF2AC11176E9D3EA6996B130CCF30FDEC83A1FE01E94213562734953B0F6D4434945C4C4A281A12A2BBB582F171730ACB8E85C648FA503B94FEC97F69CD9DD19A21FF2C27393F81A743AAC2D279570925B4DFDC9071F98E29EE093DCBA7F9D140EF70A64B22C48598F1FCEA58D2BE8476F13338B89861C8F957FB9FF00D7A9687A68160349405829C83B9A2CF7184B222A92CC1547526B39AE5653948A5DA7A3B0DBFA1E6A2C5BD15C95338A941E2AC8169AD8519278A011080663B88F93B7BD3DA31D2A839AEC85E3229AB1B13426265844DA314EA371F40351DC429709B251903A7A83ED5422AACD2D9B08EE332467EECC3B7D6ACB3760686D3D82E90E51814502E960A5A168090519A057B86690658E7B53BDF71587D19A426F40A1BE6054F42306AAC2208DCC32189BA7553EA3D2A607269D86C7669695C96B43B265A8D856D730B0C614C22A2C52D469A611486B7BA1869A6834E9721BA98431163D7B0F5A8ACA031C7B9F991BEF1FE942EA2E84F4869021292A47BB128A6B51A959886908A4F4189494AE0829290052501B0535D82A963C0148AB95E1437120B87CED5FF56A7F9D59FAD31361484D21AD84A43486C4A2826F6128A0A1299730C5751F95711ACC9FDD719140147FB3AE2D3274DB9D89FF003C25F997F0E98A58F55546115F40D6929E99E54FE2286D31A5D4BA5942EFDCBB7AE735042A67613B8F907318FEA69750B962928B805254AD46141620536FA015A791FCD5C7DD0B9FC6A02CF2C993939EA4D46B72DEC5855E29DCD69B11B813819278A8B9B86EBFBB07A7AD027A227C6052629808541A4C628B03D85C514C2C21A4A006484152A406DC3183549229B4EC14024B73C3281CA7B8A6B4D43465C8E449503C6C194F423BD3E8276D428A7B15B862928DC068CB1F6A7D325B0A5A9130068AADC1349114B1F9D8EC47434B04BBC7CDC38EA2A9216AB526A29596C4B4770C951B2D6B23044656A365A9191914C22932BD461A61E013E945F42BC8A680DCDC993FE59C7D3DCD59E940D5C4A4A4021A0D2189486902D44A434AF7656C25252D8189452B805250082AAB1FB5C86353FBA5FBCDEBED42DC6DD8B3C0E8303D28A6C3A8869295C761283409EC251487A0521A43B5C2929D804A6CC91CB0B4532ABC67AAB8C8A185AE648D3892EDA7911420FCB1B72A4FB0ED565752689C477D0981CF01D7943F96714EFA6A3DCBA1830CAB020F71452B005153B075129AD4F71B2265CD205A7641724A434BA82572027CE6C0FBBFCEA745C714D0587525200C525316C1486995710D35DB1D3AD024205C724E4D079EB4C9D99525B792DD8CD67B40273243D8FB8F7A9E09D274DC87EA0F514EE3BDF5649466900534E58E01E29A57258E1C52D3BF41D828A37D41AB853724F15448E038A8661E5BAC8BF461ED46C2DD6A4D1B6E50477A71349A06CEF2E34FD5ACC6E687CF4F555E7F43550DE28256689E161D430CE2AB9933071B0E0F1C8328C0D359698C8D96A261498D68C8D8553BD72710A7DE7E3E9402248A21146117B77F5A5345C7D04A4A91B10D2503484A29305B084F14946E5741B4548AE0692829894517179104F231610C67E76EA7D0549144B0C6B1A745FD695F4063A8348AB0941A1886D140C4A2980868A560EA2514869055576374E63462235FBCC3BFB51BB1EC580000000001D00A1806428C32A782A7A1A7B82D0A274C101DD612B5AB75DABF709F714DFB7CF6C42DFDBEDFFA6D1F2A7F0E48A3A6A3B365D8E449503C6EAEA7A329C8A5A84BB890534D31884668C53175B8B503932B6D53851D4D1B30D491502A800600A7629D877D02929005253101A69A6C36109C5340EE68E803A92840155AE2D8993CF81B64DDCFF7BDA980B6D74B39652A63914FCD1B751FE353D1E626EC34E49C0A5030314D896BA8B9A334D030A2A5DC131339E01A5AB277D45A5A2C3B90A7EE5F67F01FBBFE152839A684CF6FA82E6CAD6EBFE3E2DE2948E8594123E86A09DCC7BBF0869F2826DCB5BB939057903DB159575E1BD66D4E2DE54BA4ED9E08FC09A6A4D6FB09AEACCA96E2EAD8EDBCB29A2E70495C0CD22DDC0FC6FC1F43C5527757426ADB84CE110B1E9552D90BBB5C3756CE3E94D5F717996290D4B631A69A6818868A43425252DC12684269282EE84A4E948484A2905F50A8679444BD32C7A01DE921DD05B4262425CEE91F963FD2A5A6F5179894521DAE250681F51B4520F2128A04C4A299484A2815CAF33B48E608F8C7DF3E82A58D16350AA30A3A0A4B61EE2D2D1718949D411D8F51EB4340537D3514B49672359CA792D1FDD6FA8EF4CFB65CDA1C5F43BD7FE7E211F2FE23AD0DF463B16E191268C49138752339069D48130A28EB615EFA10C8C5CEC5E3D4D488A15428180284362D21A760F20A4A061453B92B41A69AC7";
//        String end4="1CD20B8801EA696982D58521A61D429298882EAD84E4386D92AFDD7FF1A8E0BA777304C02CABD483C1FA5343F32D0E0514C5B0BD29284C1B0CD2139E051E626038A753EA4585A298ED6192AF98B8E98E86885F72F3F7875149AB203DCA8A91051400C9A18A78DA29A349236E0AB8C83F85626A3E11D0EE0195ADC5B2A825BC9C22FD48E94BCC4CF3F86D849B6385F6803965E01F7C54DB750B7188DA19D1470A5086FCF35B27A6A4AF313FB5234E2E6096D8FA91BD7F3156239639D73148AE3D8D4EC3B580D2521D84345024B41290D4EC3B8DA4A076B20349498EF7026928B0AE35DC46A598E00E6A18233237DA251C9FB8BE83D695C375627A281D84A290EE25250CA128A42D909451B86E251402D84A86795B3E545CB9EA7FBA3D6930F31F0C4B126D5CFA927B9F5A75363484A28630A4A7D0028048E87152EC3294BA64064335BFFA2CC4E4BC5F2E7EBEB519BBBBB3FF008FD80CC9DE7800E3EABD68BF416E5BB79E2BA4DF0481C77C751F51492316631A75EE7D052F20BDB51E88147F5A5A77B8D770A4A620A4A687B8526690AE349C7269A064E4D3B85B41C4525055C2929917EA829295CAB0C63D85365812640AFDB90C3A83EB549E843D48A299E17F26E1B27F81FB30FF001AB27AF34F7D476D028A7E40C6B1ED4A0014856EC2D2D364B5D58527D29F5D03743BB5452A94712A81E8D458146FA1EE94548828A002B98F1D6A663B61A6C0C3CC9B06539E8BE9F8E3F4349F60BD8E6A08BCB8FDCF269C456AF421EC31B9041E41ED54A6D2ACA47DFF0067557FEFA0C1A4172336F7F08C5BDE9907F72E3E6FF0A6FDBE7878BBB271EB244415FCBAD1A30B12DBDFDADC7FAA9D49F43953FAD58FF3C54BD07756129296C3DD682536A7718525361B89454EA3B9580FB5C9CFFA94EA3FBC7D2AC9A7612DC4A4A0A6C28A4161A68CD00252501B851400949490FD08AE27F2F089F348DF75696187CA5C16DCC7A9F5A3D40929282828A2E025152D8D3128A4B515EC250095E4123E954C7D0A179656F2CE1E15F26E4FFCB58F8207BFAD08F7763C4D1FDA62272658B86FA907AD524AC1BE859B7B88AE5774322B63A8E847E079A9293EC24C2929243B052530425213819A6C4300DE727A53B0681B770A4A620A2804369AC4F4140DC815714B41290C9A28E68CC7220653D88AACB23DA3F97331688FDD909E9EC69A0D1A2D0218641CD04FE74C15AC0062969DC7CDD05A2852D08607DA947142D456168EB4C2E7B7D15220A28020BEBA8ECAD24B998E1235C9F7F6AF3D32CBA85DCB7B3801E46CE0741E829A5777225B0F6151B5582D461A69A918D3402474247D281AD4AD75656B75FEBEDE390FAB0E6ABFF67CB0FF00C79DECB07FB2795FCA8D8060B8D4EDC7EFED63BA1DDA03B0FE44D3E3D56D5DF631781FFBB2A91FAE3153BEC245B0432EE560CBEA0E6933435A0DD9EC2514BA14AC25579D9A57F2233C9FBC7D05213D89954468A8BF7546052D1700A4A4C6149406A21A4A0350A4A9B94C28A6815AD612A3924D838E58F41EB40C6C1094CC921CCADF788FE42A5A6C4829295CA0A4A40145300A4A48008A8A57C7CABCB1A4C43A34D83D73D69C090720E29BDC68AB71616F3C9E704F2A6ED2C7F2B7E27BD4466BDB3E6E53ED517FCF58B865FA83D7F0A4FB0ED72C5BDC4374BBA090381DBA11F515253770E806928174109C0E6A300BB64FDDAADC76B8FA2A7A8F41A68AA26C14940741ACDE9D691571D7AD521798EA4A43BE82523A8652180208C106A9C42D72A333D9B75DF09E83BA7FF5AACA1046E0739E869AD891C2968B0ACC28CF6A3A8EEC514A2991ABD4514E452D4ED7D03567B6D150014500723E32D40DCDCA69D0B82919DD281FDEC1C0FF003FD2B2F608D768AA85EDA92D6A44D519A64B1A69A691571B49498D086928F318D34C9A349976CC8241E8DCD26AE0B6297F645B44C5ED1A5B37F581B6E682BAB42722686ED7D19486FCC9A2F6DC4841AB471F1776F3DA9F561B87E99AB50CF0DC0DD0CAAE3DB8FE74AC1BEE36E65F2D70012C780052C10F949824176E588F5A4579125252B06E25140D0868A62B89499A450525217A852521A1B248B1AE4FE5EB4C85189F324FBC4703FBB4D306FA12525001450C614946C30A29200A4A02D723964D9851CB37414B147B4658E5CF53496803A8C53BD804A0120E4120FB52632ADCD85BDC49E690629FFE7B4676B7E3EB5179D7B67FF1F4A2EE3FF9EB08C30FA8EF46C22C5BDCC3749BA090381D47423EA0D3FDCD56A8134C672E7DA9D8C51B8F70E948684B40128A1B15C434D66C74EB4D0028C7D694D02B68251479809484E2AF7131003D7D6AB946B66DD18DD11EA99FBBEE29D920E96278E45914153D69F4B50B5C424F6A5029AD44C5A5A18C722EE35615702A95C84B53D9A8A800AA5ACDFAE9BA7C9704FCDF7507AB1E94847116E19F33CA49924F9989EB93D7FAD39CD69B686642D4C341434D34D017B8DA4A4C7D04A434AE90C434DC50C109454BD0032718C9C7A66A85D69BA792667B74461FC69C1FCE95C643059DE2AACF15D0DDFC2B382D52FDB2EE0E2EECF728FF00969091FCB34DB42499241A8DA4E76A4C037F75C153FAD59E833EB4AC34C4A2A4A4251413B0949D2994B40A4A435A85359828249C01487621894CEC2671C0FB8BFD6A7A76E82425252430A298C4CD14005152006A391F60E993D80EF4C4243195F998E5C8C1352D304B4D44A4A43425254B61B8520241C8241AA195AE6C6099FCEC18A61D258CE1BF1F5AAE67BB839B906E610799225E7F119A6B5068B704F0CE9BE270C3D3A11F514FA350139A2982133C5148063301C77A1571C9EB4D09F90B453012909A183119B14DF7AAB098E149ED4AE1EA40F1BC6FBE1E41FBC9EBF4A9239D244051B27D3A538F627463D47734EAA1DEC3A940DC70290BA13C6BB454956F405647B251599215C5F88EF4EA5AA7928C4C16FC707866EE6851BB426546F94003B544C6AD99D8898D30D0525D469A69A43B09486930B0949482C368A4C6BA8DA2861AA109C7355BFE3EE63D0C29FF008F1A56D7506EE583CF340C8E4123E940D10DCDB417431710472FFBEB9AAEBA7087FE3D2E66B6FF00654E53F2A13B06DB06FD4A0FBF1C374A3BC7F237EA6946A56E582CA24B76F4917FA8E28760B965595D772B2B0F50734548EFD82928DC76B052520F4109C724D418FB43E5BFD5A9E07A9A064F494EE09F70A4A436C28A2E0B6128A0370A290C6C8E1073D7D29238FF008DBEF1A105C7D14C043499A3701292921A12834808CE5CE074A78CAF4247D2A86DEA559EC61964F39730CDFF003D63E0FE3EB517DA2EAD38BC41327FCF784631F55EB4EFA589D596E395268C3C4E1D4F714B421894D66DA3DE9884453D5BAD3A98D09494AF625BB89DE909C53DCADF51BC93CD2D172028AA2B60271503C2E8E6688F2DF797B1A056268A4591723F1F6A7D559936D751473C5588D702A96C03C734FA5B0BCCF63A2A0464F89B53FECED3F11B113CDF24783CFB9FC2B94B588430F724F73D6AA0F725831A898D0C923279A69346A52434D349A063690D20D84A4A3A025612909A860FC84A4A2C1E457B9919D84111F99B963FDD153A224681231851D05016BB169290D2B81A4A4F51EC3687F9D76BFCCBFDD6E45362B950E996A1B7C519B77FEF40761A431EA111FDDDCA4EBFDD9972DF9D3B8EC21D40C63FD2AD2687FDA5C483F4E6A782E21B81986557FD0FE4695BAA0B8FE9454B1AD881C999FCB53841F79BFA0A942850001803A014EC1B8A69281B0A281894520B852517B8C29AEC11724D261B8D8D096F3241CF61E9525084828A63B0D3452BF70B89494AE02546497381D0753495D8C76368C0A5AABE9704F512932472090686EE365592C63F31A5B7636B33725E3E037FBC3BD33ED73DB1C5F4436FFCF788654FD475154857EE5812C6E81D1D5D5BA1539CD0A39C9EB42D43A8EA4A3CC5B052531EE349C0A6673C93427A893B31D47155706EE1484D31BD50019E4D3BB526C8BB2278F0C644E18F5E3AD4913871C0E7D29A44F5B96634C73528ABD8685029D498DBB1EC7484850492001C926A48385D42F7FB5F536BA1FEA53E58BFDDF5FC698E6AED648CF9B521639A8D8D16D0AD1119A434810D269A680129A6931DC42690D2F2174D00D34D0C7A05437130893D58F0A3D4D4EE53B316088C49973991B963FD2A4A6C4B6128A900A4A01B1292920DC4A434C680123A123E955AE2C2CEE5B74B6D197FEF8186FCE80633EC77112E2DAFE4503A24FF00BC5A865BBBB8F314D087C759210718FA52DC17727B5BBB371E5C53018ECE369FD6ACFE23F0343DCADF40A4A03A052500B50A290C4A295AE0233051934C8D4BB798FF0080F4A60F525A295862514F601292A64025250808C92E768E83A9A7050A3038A682E2D250862521A3A89F6129934CB046D23B6028C9F7A1EC348A16B6C26B78EF2D5FECF2CAA1FA654E7D454AB76F09D97B1EC3D04A83E46FC3B555FDD0DC965B9B785774B3A283D39CE7F2ACCD4B5A5F284764C4B31C33918C0F6A9D65A235A705BB2E69974F7B66B2C9B430255828EE3FFD7561D822E49C015AB5632B5D953CD96E9BF70DB117ABB0EBEC2AC226D1D4B1EE49E4D11D16A277BE83BA0249000EA49C5549755B089F63DC027D5549029396B62D2BEE4C9750C83744CD22FAAA9FEB8A9473CD524D68CC9D90B8A5A561340327815345101F31EA6A93D07AD8945385326CC70A5ED421B3D8EB03C61A97916AB6311065B838618CE13FFAF8FE750D37A2219CF429E4C2A9E829AE6B6666B6D48C9A8D8D4DCA4C6934D268DC341A69B499484A43498094D3498D6C25252B83D0476088589E05416EA6693ED320FF00717D07AD097516FB16292A4A614504894948A0A4A499221A4A6312834CAB114D2118441976E9ED4F854C49856393CB1F53483A91DCDADB5D0FF48B78E5F76504FE7508D3FC918B3B996DFF00D9DD94FCB142D01AE82799A841FEB218AE57FBD11D87F234ABA8DB16DB21785BD2453FCFA5302CA9565DCACAC3D41CD57BEBFB6B08C4972E403D154659BE950DB48A8EA52D2FC416DAA5C9B786DE68D82EECB918AD41EB4ED60169ACC114B31C014986E4718337EF1B85FE118FD6A61C55356041452430A4A03712908A3741B094C24B1C29FA9A901400A";
//        String end5 ="3028A6F40D80D252B85C4A434C6349C563EB37392B0A367F89F07F215151BB58D61DCB9A31CE9169938DB10DC4F6AA377E228D0B476D079AA782EE7E53F856B2BB7CA1085D5D98AC776F95210A8CE7955E01EB8A40DEB56A3CAAC55F437B401E5E95E739DA2590C809FEEE00153AE6F36BB82B175087BFB9A72F8AC60DDC9A59A3810191C22F4155C5E49720ADA46148EAF29C81F80E6A6CD956B2B8C974C373FF1FF007B25C01D1221B147E041A5834AD3ED5B7C56C0B7F7A43B88FA714D592B1326E5B96C024F34EE879A6B5245A5EB4ADA8589624C7353553B13D0514A298DEC3853A8E80CF5EB99E3B581E799B6A20C935C07DA24D46F24BF9F8321CAAF651D80A217BDCCA5B0F76A898D317A11B1A6934B604C69A6E698C69A43498751B4868B83426690D40D094526C6915581BA9B60FF00529CB1F53E95669F415B50349498FD4292A400D253B031292922AC21CD14585BB12992C9B17D49E8281DFB890C7B32CDCBB753FD2A4A1820A4A0ABD8291C798BB64F9D7D1B91408A874CB556DD0AB5BB7AC276D67EABA3DEDD32C82EA394C6B84DF9C8E79E69308BB1069060D2E5B88AE837DA7772E06EC0E38ADB82E619C7EEE556F6CE0FEB4D85EC4A7E5193C0150A8FB49DC7FD503C2FF7BDE90D9628A4B40128A630C518A4D5C4211498A10C8D8963B57F134A1428C0A4BB8C29286014949E8021A8E591231966005305729EA977F64B0330204B21DB183EBDCFE55CFC0A15001DBA54CAFA9B457BA2DD5ECA6D96C8301083B88EE78E9F4AA278E056D4E3A5D94B4D0B69712369D0599501223BB8EA58F52698626EACA429AD2DDC1C74B22FC770FF00202E45B45F76127E5A986B5852D1C2F3607F08A8DC9E556F7999B71A8DD5D10D2841B470AA0E0558D1753B7B3498DE4AFBE5231B53380288C79346672BE9634575BD31CE05C32FFBF1B0FE951EA5ABC504605BB09267E471C28F539A96A4384537A99AB7FA94CD96BD9C7FBADB40FC2B5F47F36485E59E69253BB6A97627A609FE75B4528AB1327265FF00A54B1478E4F5A48C9EAC98528A1AEA37A0E14A2842BF51C29450173B6F1A6A6D248BA5C0DFED4C47E82B29408D028EC29C76B98CACD8C634C634D811934D26902DC4CD34D05586D26680D86D04D2E8034D254F51A12A0B9918910C7F7DFBFA0F5A3A82DAE4B1C6B12844CED1EB4A6937A8740A28EA02506A58F51292800A4CD2602514C431D822E58D322425BCC907CC7A0F4A00968A0AB5C2928D86829280B852119A4CA191C51C52BC91C488F21CB3A8C16FA9A8AE2C2CE73BA5B68CB7F7F6E0FE749B26C41F6390E521B8758FFBB29DC3F4C54DE75D45FEBADFCD1FDF8881FA1AAB8D0F8AF6DE56DA24DADFDD7041A9FF0023F434B50BF60A2818628C52630C546D9276AFE7498B6D45540A28229B1A1B486958109494AC3D8633605645D6A31A5E29954BC4AD820761EBF9E2A5DD58D2314D5D90789CB7F682404F112678E9924F3FA56713B622475A35EA5A77688E1884AE77938C66AE3A4314127C88011D71CD7524AC3E54DDD9477719514F82EA756019FE41D7776AD1A48A93D3421BCBADF212AFB973C7351C375321CC733A67FBA7159423633BAE6D074BB9C87762C5BB9E69AF83C0AB7D852DB516DAE64B493CD8667471C6E43834F5796EA6F32462C4F56634924DDCCEF6D0B90A8185039270315BF671182D6389BEF0196FAF7A57D1932EE5B8E3EE6A5028621453A9AD0428A701DE87A00B4EA6B516FA1AE0BFDA24B89D8C92C877337BD3CCCBDCD3F246226F0DD08A69345AE3B8D269A69361610F34DA371B1A692A7A0312909A40869A4A18C8E794451963F403D4D36DA26452F2E3CD7E5BDBDA84226A4269345740A4A42414940EE04D26695C77B899A4A4C570A69381934363DC8A21E7B09987CA3EE83DFDEA6A6C41452B80945162EE1494C570A4A018544C4CADB41C28EA7D690F744A8A146052D161A1B2A2CE31328907A3F3508B358FFD449241EC87E5FCA8135D433791FDE11CE3FD9F94FEB4E17916E0B22C9137A3AE7F5149B15FB93A10EBB94823D41CD3B1436318D92768A509814241B8629A45328611498A942D58D34C63814C7B14B54B9FB2D9B383891FE54FAFAD73C9D79A86F566D1D921F7D3799F6762C4C8B088DC9EE477FD6A157DDC11C1AA8EA5AD0B96F6E0264A2E71C93DAAA6A2711A8575605B9DAC0F6ADEFAD871BDAE886DD4FE7516A00AEDC74E98AB6C5776640913B8E94D398DF6B70453B1934D0EDE4D382B3E4FA545889498A10F941C2B119C1214E07E35761B2BB4B41709189623CE623923EA3AD2BA40DEA85D3AFC5BEA30B4A8420255B2391918CFE75D7F9251C86EA0E285E64CC900A5146A82F61694535A8BA8E029D4C3CC514F8D1A490468A599BA014D2BB139591A6D201D4E298581A7639D318CAADD40349C8E8C6A45B09E6483A1047B8A4FB41E8D1B7D4114169D83ED099C16C7B114E0E1BA1CD22B7109A4340C426933492D01099A6B305193DA9015E3533CDE7B7FAB5FB80FF3AB14ADD05E619A4A4361494092B05250361486A4AB894669874109A831E7B91FF2CD4F3EE684264F9A28D8AF2128A42B05142041494D95A052502F423662E76AF4EE6A4550A0003A520EA2D1490D3169714C050294AEE5DADCA9EC7A52DC77231A7DBEEDC88626F58CEDA582D351B89DE0B18A4BD68D774815465076C93819FF000A7E467F089E6BDAFCB7765756C776DCCB0B004F3DF18EC6A75D920CA10693F33410A546CB40C6114C343EE046C7155A5BA82227CD946E1D54726A5CEC8B8AB98BABDD8BBBA531EE11A2E003EB9E6AA28E6A63A6E6B6EC36E1199495192A326A18A55B606464124BFC0A4F03DCD6F4DD90ECAF6654BABA92E1BF7D297F452781F853237109CAC684FB8AD52B222524F52E437E84FEF06D27B81C525F323BAE1B2B8CE6851B169C5A235915075A1EEE229B5EDD987AB11C7E154D839248AB6ECBBBAE40AB7232A21C753D2A198A6BA90A4D3AC46359E4119392818E0FE15269D7B3E9D722682464048DE14E370A5722FDCEB7EC7A7EB10F9D284BA07AC80E1C7D7B8ABB6F179102421DDD631B54B9C9C7B9A22AC98B72414B4F615D5870A51430D10B4E14215EE3E34691D52352CEC700015D0E9B669A745BD8EE99BAB63A7B0AD63A26CC67AE86379CE3F88D34CDEA01A1EA4F40F373DC8FC68121ECE3F1150900BE613FC39F7069378EF43BA002C9B72CE8A09C7CCC0734D64527900FEB49329681861F75D80F4CD1BE41DC1FA8A4C13B079C47553F852F9AA7AF149A2D4D31410DD0D579499E4F254FCA39723D3D29037D49C00A000300741451EA0BB85148189452189450210D25200A4340D32272646D8BC01F78D4A00550AA30A380298F761495220A28D8370A4A63414501EA1513B962517F13434098F450A3029D40EC14B498C5A502816A3C0A9152931499359D95D6A9782C2C00F34F324A465615F53EFE82BD0F43D1ED744B216B6AA793B9E46E5A46EE49AD63A47D48DD96EE2DE1BA85A1B88639A36EA9228607F035857BE06F0FDD38912C56D580C66DBF779FC07D2A651E62AED6C61DE780752B7476D3F568E703EEC5710FCC47A6F0DD7F0158B7DA76B1A763ED9A45CED3FF002D210251F92924566D72AD7FAFF2348BBBB2FEBE667C77704C4847C30EA194A9FD6964F946690CAD35B25C0FDE34A3D023EDAC5D4224B6731452F98DFC5FEC9F4A9714DD8D2176F5297BD26FC9AAB6A6B6EA4371315C8538C8E714DB3B7F3D4CAF9C678F7ADA0AD7613D1685C68E3D9B5D1587A30CD665FDB246C1E25DA0F503A0A22F525ABAB15761ED52229E01ADF62541A64AC8A80161F88AB16A22619520D4CB465B4AFA8F96DE2906762FD40AAAD00276E7A7AD66A44C9732D0824011CAFA50B8F4A48C9D93B17B4CB99AD6F2392D8E246210AF671EF5DBC8A048E0740C40AA5AA334F5B094B4C76D0514BDE843BF41C29CAACCCAA8A5998E001DE9AD7433968AE741A6D82D827993053707BE3EE8F4A6DE5CFF00B5815BEDA2328AD2ECC32D484D473084DD9A4DD52F42BA081B1CD2F987D68E82473FE3A89A5D3EDEE514130C9F31C76EDFCEB5B48D412FB4C82E14B82CB86C9EFDE8E835B1704A7B1FCE97CC3E80D45841E60EE314BBD0F7A4D30B0D6553D40348ABB7254E33D68B82761DBDC771F8D1E691D509FA54BD4A5317CE5EF91F852ABAB742295AC569B8B9C5146C02668CD20B075A4A10AC254723127627DE3DFD28431E8811703F33DE97B5170484A5A57296C251405D8525082C14531364523927627DEEE7D05391020C0A0571F4505217140148ADC7014F028EA0C9553353DA5A5CEA3782C2C57331197908CAC4BFDE3FD077A12E676219E83A26916DA2D90B6B604E4EE791BEF48DEA6AFD6CDDD805148028A00E7BC5FA67871ECA5BCD634CB59DD97607318F318F601BAD79843A7982150B2BA4807AE57F2C572F35EA34B6468A168DFB8D79EE6DCE2511CDFEE7C87F2358D7AB165CC285003F74F34FA9AC2372801233F0A48F5ED51AB996668E33B8004823BD744628D6F6D47CA912C21DA356751F36E1DEABB6A570BF2AAC4A07006D3FE34E4B506D2D589F6F9DBEF797F82E3FAD477171E66015C51C9677137A5C6C69B8E4548806EC6791DAB6760D5C6E8B31461B8600D52BE8DED2E65DA98497EEB63B7B5290A4EDA92E9F3B4A932CF7A51C28F283027712718CF6AB06CAED6F62B568499A53F2E30411DFF9564D45333752F1B0CF14258D9EAAF6D6D184319C3B07C863CF6FCAB396418CE78EE454A6DABB339D8ED746D1EC6D163BD8257B96953292BF0003E83D6B4EB49CAE4242D2D4A2AE2D28AAF21F41C0124050598F000EF5BDA6E9EB64BE74EA0CE7D47DDF6AD69AB6A613F7B416E6E73902B0EEAE9AE9CC71391129E5D4FDEF614E65EC8C36BDD521FBE7701D8AFF008D2FF6D4AA0096DC9F751FFD7A8B5CE7E7D6CC963D66D9BA8743DF3CD588EFADA51F2CEBF91A4F7345664CAE1864329FF810A09A09D886EE04BBB6781F055C77F5ACEF0B46D6BA7CD672106482721B1D3A0A6AD67729686B6697754A0D2E01C8EF479873D295BA831CAEA3A0C52EFF007A5B8741439F5069777A8A9B08370A6C88B20C714862A26D5001C7D297E71D1B3F5A2C09D837B8EA01FA71479B8EA08A4D0D3144A87A353B20F7A965AD48E57DBF2A8CB1E829D1A6C1C9C9EE69AD818EA4A57185140BA8525030A28B0D894C91CFDD5FBD4122C68107B9E49A7501E414B40EDA0A29C280BD87A8A9117352DA0722C59DADCEA1762C6C541988CBB9195897FBCDFD077AF41D0F47B6D16C85B5BEE624EE9257FBD237A9ADA2AD12517E8A630A2800AAF7F7B069F6AF7370E1513F53E82A272E58B65423CD248F39D73539B56BC373370AB911C79E107F8D635E4EB044F230242F381F5C7F5AE4A717089B4AD295918D797715CC9B82152063079AA933851B8F7ADE3176D4D52E9729CC66954840467A60D3B4FB4684334AB863C75CF15B41249DC6DDD58ADA8305B99D7D5AB3B3EB54899DA3B007C76A94209464F06ABD484EF645981368A8C26FB9603D734DC93DCD1AB46C5D45080648CFD6A1BCC4F1857FE1E41F4A52DCCFE233FC82C4A8193E95774DD46DE17116AD05C5DC517CA804B8F2FB1E31CD4DCC5A7D19D7D8269B25AACD6105AB42DC0658C67F1EF55751F0F69D7E098E35B39F1C4918C2E7DD7BD4CAEF71A5617C396D2D8D9CDA7CC4192DA76E4742A71823DAB4EADB560D9EA0296A2E0C70A50092000589E001DEAD2BB25E9A9BDA769EB64BE6CC019CFF00E3BEC296EAE739AE86ADA2318AFB4FA98779726E9CC519FDD0E1DBFBDEC3DA88A30A000300564F53466BCB1B37FAD566F6604D53974EB37EB6C83FDDE2A5A32E6B94E7D02CA51C075FF81647F2ACFB8F0A237DC9633E808C7F4A3526D7D4A72786AF613988B1C775606A168B5AB3E3CD947B73426909B6AE346ABA8C7FEB60127B918FEB5043ABFD9B599679AD9F65DAF3B78F9B34D2D4B563523D6EC25FE278CFFB4335623BBB797EE4E8DFA7F3A5661744A39E4153F460693345C7717346EA9014353839A57017CC346E1DC50D0D8BBBDC8A5DC7B1A910BBCFA668DE3B8A180654D26C5EDC52D8041190DB8124FA9A76E9075C11F4A371A61E691F790FD452F9ABDCE295869A1DB81EE28A5D4A4145368105254AD42C3257DBF28E58D11A6064F53D69831F4503B8B450028A7A8A632545CD58B4B6B9D42F16C2C5774EC32CE465625FEF37F41DE9257910F73D0B43D1EDB45B3FB3DB82C58EE9256FBD237A9ABF5AB00A28185140105F5E41636CD7170E1235EFEBEC2BCFF5CD5E6D5AE7CD9329127FAB8B3D3DCFBD7256F7A4A3D8DE0AD1E6EE635CCC17A9E4D50D47326993B0EEA3FF0042142D5EA24B5460B707AD3EE25B36B0F2E4CACE24DCAC01E98E95D2EF6378A773356EA481809503A9EEA7FC6AD477901E4B9FA60D28DDAB94A29E8655D31F3199BAB1CD42986126473818AD16C4CEC98C51F3D5D8938A7B99434659850B0E2AA79A63B89180EA78A1AD0A9480BBC9CE4FE269F1EF3C119A9BEC9994E571E216570FB78155F5188A5C96ECE339F7A276253D0D0F05DC987546B424ECB94200CF01873FD2BAE143D4631536DC3CA07FAC40AC7D706A4A005029C0502BDC50092028249E001DEB774CD3D6CD7CE9C0339E9C7DCAD69AEA6551DF443EEAE3B035857976D74E6189888C1C3B03F7BD87B55363565A89146000A3803802A4EF8151715CE94A823A83F4351B4119EA8A7F0ABD19C69F4642D6B19E808FA544D679E8F8FA8CD4E869CE44D68E3D1BE9C546D1CC9C61C0F635162F9882589243F3C4AC7FDA5AC4F136976A2C16EA3802C96F2073B38C8271FD6924AF71C90F97C3FA75D2096352038DC09008C5539BC2719E63997E8462A9B6992E3729C9A1DDDB481229DC363202E0D07FB72DB8F39DBD98E7F4A7CCADA8D5D2B00D57508789AD949FF731FD6A44F10C23FD7DBBA7BAD27661CDDCB116B5632FDD764CFF00781FF0AB51DD40FF00766427D338A9B3B969DF625E4F20AFE0C29334360F617752EEA005DC45287353600DF9A370A403837BD2EF3EB4300DE7D28DCBDEA6D618842B75A5DB8E036298065C7423F1A3CC71D403F4E290D3144A3BA9148F3A81F2F27B0A5E85268235EE482DDCD4943120A281852D0524385488281327B4B6B9D42F16C2C1435C30CB311F2C4BFDE6FE83BD7A2E85A35B68B67F67B7CB331DD24ADF7A46F53571D88DD9A14551414500155EFEF60B0B66B8B870A8BFA9F4A8A93E48B65463CCEC703ADEAD36AB71E6CB958949F2E2CF03DCFBD6548F9AE5A69ADCD64D5CCABF9374E549E83154AF1BE6693D7D2AA2AF2B82D194FECB3490F9C814A77258023F3ACFBB5DCA475C5744E69685A97BBA951C48912965F94B6064F7A93CB7F29580E78C8AA8BD2E5736C57BEE641C630304525A45BD257F4181F5EA6AAFA5C87AB2B12463D6ACC173B70ACA4FD2822E93346DE5DC385233EB486C7CC767CE093903154AF7BB139A1534F901C1C5598AC1BFBBFA55248C9B2592D78E074AA97B67E7DB10AB974195E7159B4544CBB0BD1657D6D7601FDDB8247B7435E84CD1B9DF0B8789FE6461D0A9E86A55DC6E36F50C518A1831B73736D68BBAEAE23847FB479FC853ADE58EEA2496D9C4C927DD29DEAD5393574B4097BAAECDFD374F5B45F3A600CE7DBEED3EE67F7E6B7B59591CF1D75661DEDE1BA73142DFBAE4338FE3FA7B536340AA140C01D0566FCCD5F624F614EC802974259A40ED395254FB714BF699C7FCB673F539A0CD6C3BEDB28EBB08FF007714E17CBFC5137D430FF0A95725C56E28BA80F562BF5069C2489BEECABF9E28B92D581D437521BF1CD41358DBDCC5241242856452A78A035EA63F85A177D1FE";
//        String end6="CD3E7CFB2630C9CFA55F7B36C64483E84512B3771A915E1B29A22CECCACCDDD4FE94E6595783BBF3CD4B2D3217456E1D037FBC2ABBE9F67272D6EA33DD783536051EA559FC3FA7CBFF002CD94FB907FA55393C2D063E49147D4669A6D13CBA95FF00E11CBC88E60B903D314861D7EDF859CB81F8FF005A775D423CCB57A88351D563FF005B0AB7AE50FF008D3D35C1D25B7638EBB0E3F9D165D06E765A93C5AC5AC9FDE5FD7F954E97D6AFC09D73E8411FD293BA296BA93AC836EE52ADF46152840D079CA7E5FE545EC34460D19A2C028623BD2EF3458037FB52EF1F4A4530DFEF4E0C4D2B08377B504AF7A361000BD6979F5A3D405DCDED4A1CFA54D8AE61438EF4E0C0F7A2C5263C54B6B0DCEA17A9A7E9EA1EE5C6493F7625FEF37B7B77A718B949450A6D24D9E93E1FD12DB42B2FB3C04BBB1DD2CCFF007A46F53FE1DAB4AB4628AB2D428A0A0A2802B6A17D069D6CD7170FB5474F527D05705ABEAB3EA93F9B312A8A7F7710E8BFFD7AE2AAF9E76E88DA2AD1BF733247CD40CD5AD819526B68A490C8DB8B673D78FCAA09E58ECA17996D8295180570327EB52FDD5A0A31D4C4BEBC9AF6442CAA8AA3000E4E7EA6AA5D1D8A3DEB6846F1D4D959D8AD1AB34A15989C0C8CF6ABEF12B42548CE4608AB69204B5326F5248DD031628ABB109EC076A8D58AA601C64E69A6AC44B47723E09E4558860C8CF5AA464F53534E428E0F43FD2B5E087277568AC432D7921B8A1D028C54E9D04B52BCCCA8A76AEE3543CC2920E3BD4B2EFA58D0B5B4B4BA960BB6B78FCE8772C8428FDE6463E6F5ABB6B10B789604188E31B50139C2FA524F4B02DC95D96342EEC1147566359973ABB3FC9641907795860FE1E95D186C3BAD2B741CAD6BB337ECBE6CEA8A866B894E00EACD5DDF86B424D0AC163936B4E58BB607084F615EA621C630B7C8E59B72972976E27C771F9D615EDEB5CB18A06223FE2707EF7B0F6AF2A4CD62ACAE3628C28000C01D055CB4B492E4FC83E51D5AA22AE4DF40BC856060109607F4350A8EE69B29A3A692085FEF4319F7DA2A16B2B73FC2CBFEEB629B471293217D3D4FDD94AFFBCB9A85AC261D2446F6C63FAD43563553BEE44D6D70BC988E3D88350B823EF2B7E2A6A4D134C6AB95E63257FDDE2A44BB9D0E44AC48E9BB9A19479E5C788354D3BC537372F772AFEFFF007A88C55587D2BD0D3548AE7F7A96EE237F994EF0723F2A2D65A0A5AA4482EA13D495F6C66944B131F9641F8F151A92D08E81BD0FEB4C36F1E3EE2FD40A03A0C6B753EB51B5B1ECDF98A417646D030F7A69575F5A07CC35831187CB7B37350C96D049F7E143F514864474DB16FF00596B1B0F71556E744D3DEE1C5BC588BB127FFAD4736A44A2539BC34436FB79FCAF602A35D3359B5C9B7BA600F50AD8CFEB55CFD1859A11AE35B807EF143E3FBCB9FEB48BADDCA1C4D6609FF60114248AE6B6E89975EB6E9241329FCFFA54E9AB5938E2665FF790FF00853B3EE573449E3B8825198E78DBF1C7F3A979C6783F439A45099F7A5068106E23BD2EF34AC02F9868DF4ED706383FBD2EFF007A4D00E0E29C083D4516B0C72915A3A26B3A8689E70B0168CB3B877F3A225B2063A861522B27B9D1DB78F0E3175A54A0FF007A175607F02463F5AD3B7F18E912FDF92684FA3C4DFCC034D49319A369ABE9D7B8FB3DE44E4F017760FE479AB955B6E34EE154F56D4EDF4AB533DC375E1107573E82B3AD53920DF534A70E7958E0B55D4EE352B9F3EE0E31F7230785159CF266B9E953E58D8D24EEEE42CD9A8D8D697248C9AC8D64B3CFB07454040FCE87AEE5276284F108D94FB555BDDAF186539DBD47D6B652B9A4159EA54591A3943E3B608ABE970AE38C8F6ABDCA6D15351950AF9451F3C10DDAB3DCE39A76339B18AD9715A36846E03F0AA462DEA6CDAC20FCCB5AB02E0722A919B247711AFA93DAAA4F3AC2864B87555A5A2292BE88C9BBD60B315823DABD99B9CFE55505E399034AF95EFC5251EACD1A4F4469E99ACD925CAA198FEF30BF74E07E95AF7DA8C3699451E74C0E362F41EE4D14E9CEA349213D37326E2596E983DD481B6FDD5E8A3E82AAB5D3CB709676117DA2E65E1547415EEC60A94542265277BCE5B23BBF0D6851E8D079F3B09AFE5FBF2764FF00656B4279F19191F89AF3ABD4E69791853BBD5F5302FEF9AEDCC503110FF138FE3FA7B5241161471803A0AE45AAB9BCB7B22FD95A35C48848C45DD8F7AD5908B06F2E1C10475157B2335ABD762BCB6CAB189241956E40ACB752188F4EF4A5A6869D2E6A0BDB91D662DFEFF34F1A8CC3EF2A37D062A2ECC79531E3528F1F340E3DF783FD29C2F6DCF57DBF504FF4A2EC4A9BE83D658E4194914FE38A7166FEF71F5A37DC849A2192289FEF4487DCAD40D6901E89B7FDDE2849317333CF7E25E94967AB25DC59F2AE81DDB8F3BB935BDE0877D47C3916D75DF6C7CB6073D30314ED746B4DDE1A9AE6D661FC00FD18546D1483EF46D8FA66B3B8D3B8C04AF00153F4C5384F28FF00968DF9D4B1DC77DAA51DD4FD452FDACFF1283F4E2A6CC561DF6943D55851BD0F538A3506BA8B843D08A43103D853D1EA4EA46D083C533C80BC0CD1E41762188D30C6451A17CC1F38E8CC3F1A63206FBE037D79A4C772092C6D64E1E043F418AAD268760FD21DB9F434264CA172AC9E19B463946DA7DC67FA545FF08F5C447305D14FA1229F377172B06B4D6E01C5D9603D5F3FD6A3377AC43F7E38DC0F54FEB9A69C5AD4AE6B6E2AEB53A7FAFB2FAEC38A9535CB53C3C3347FEF55582324C99755B27E7ED1B47FB4AC3FA5588E78641949A36FF810153A97A0FED90411EC41A3345C050C69C1C8A6087890D48B291E9480952E07707F03532DCA9EA7F319A4D31DAE2B7D966187589FFDE5FF001A9ED95ADCE6D647838C6617DBFCAA2CD08B2BAC6AD16026AB71C7F7F0D55EEEEE7BB984F753B4D285DA1986303D2B3942ED37D0B8B2B3B93DEA26635A4514A4319A985AA5A63E62376AC8BD9775FCA9FF003CC6DCFA91FF00EBA57D50EEB7337509C88D36004B1EF544C5313BCBEDF619ADA3A6ACD2FA590AA85CE49AB112EDAB16AF51F241F6842A07CDDB1EB591323053BC60AF514DBBE8549DD15D8ED20D5BB49802BF515499CECE8F4E9A38E32D2CA88A3FBC715349AE59C6BF224B3367F87E51F9915139BBD90E10BEEC81F5C4642CB672071D374808FE55877D772DDCE649892D9E07F77DA9C5F331B4A2B4203311DF34A12498F00FD715D108BA92B215EC5EB4D3940DCFC9CD5C964B7B24ED9ECABD6BDAE48E1E16898C6F27A944CF79A9DDA5A5A2B33C9C246A7F53ED5E81E18D060F0FDB641592F241FBD9B1D3D87B572CAA72C1F766755F34943A234DE6C0C640FA9C572DAEEB8D74E6CAC98AC40FEF260796F61ED5E649B93B1D14F4F7BB1269522C90E33CC7F2915BD63A45CDCC6B33C6CB09E9C75AA8C2F76CC652B686834A91C26CE34C3AFCA08EC6996E91A238B81F37F06695F5B956B5909106B97D8E708BD39E955F528C12228906E43D477A1E88A52D5DCBAFA7427EEBC8BF539A85F4D9072B7087D8A1FF001A971397DA3EA42D6372BD02B7D081FCEA178674FBF0B81EC33FCAA5A45A92642C149F993F35A03327DC665FA1C522D771E2EEE07FCB790FB16CD0DA95C463FE59B7B15FFEBD21348C6F1A83A9F879F744BE740DBD48F7C0AC2F86BAB259EAB25ACCE445769F28EC1BAD524EDA045257477DF6A83BC807D4114F5746E55D7F03595C5CA23007EF73F5E6A268213FF2C93F2A625B8C36B19EC47D0D44D6A3B31FC698EEC69B57ECCA7F4A3C99076FC8D20E6236461D54FE551B3B270A4A93E9C5268A4D0E592403E6727EB4FF003DC77A961617CE27A8A3CC07B520B0BB93B9A4F90F71409A61B01A698C5310D31D34A5164CA5223F2896C9EDD2A4CBE31BDB1F5A394771AC8ADF7914FD4543258DABFDEB78CFE1405AE579344B093930107D8FFF005AAAC9E16B176CAE14FAB0CFF4A14899434187C2F346736B7613E9914874DD721FB97AEE0762FF00FD7AAE60574465B5D88FEF238DFEA993FCE81AADE47C4D63BBD760C5175D07CCEFAA244D7211FEB2D275F7C83FD2A68B58B190E04C41F42A4FF214D96A48B31DF5B3FDDB88CFB138A9D5C1190CA7E8C295C7E83F7D1F2F5DA3F2A4C342413C8381238F6DC68FB449EA0FD450D772AC1E79EEABF8714DF381EAA47E39A120B210C80F7A6920D26818C216ABBD95A3C8643080EC72594E09A04EF62A4BA0D93E0ACB708474DCC187F2AAD71A1DC37FAABB831D94C6C3FAD3E6E85C66D3D4A4DA3EA719F922590FAABA8FD09AA723EA11E565B59131DC464FF2CD5377D11A46A248AACEF2B61DDCFB1C8A7C8816061ED57B20579B283039A96305402293664694016E1031201ECD8E94F28E9F78529456E86B5D09235CF20D675F6FFB548CA8C413D4038A54E2E52D0A6EC992DA69F24DB5DC601E706B4E3863B74CB15181D4F15F4586A4A8C2ECE5BB932B5E6A98F92DF1EEF54A08AE2FAE961814C9349FE726B9A5373924CB9C9455CF44F0D68B06876DC624BA907EF262307E83D0569BCC173C81819249E95CF5E7CCEFD8CA9A6F7DD9CA6B9AEB5F335A59395B7070F28EAFEC0FA74AAF6D6BBD151063B0C0E4D674A3A5FB9A4A767CBD8EC7C29E0E920985CDF746C154E9F9D76D77710C16E6D2D57716F94E3B7FF5EB7ABA45451CF06E52751EC73F7BA7369A44D33E64272063F5AAFB5EF8F9A7851C1C57238EB6EC6F7D2FDC5B99965455B70723EF11DE902A25BEF6E651D47AD24FAB1F90BFDAB1FF0015B4BF50E3FC29C351B66EAE57D8A93FC854DDB399C3B0E5B9824FBB321F6271FCEA404F5561F81A4DF425C5A18C77FDE3BBEBCD40F6F6EFF7A08FFEF9A2C5EAB5226B1B63D1597FDD6C542DA644C772C8E0FA1E693D0A526452E96F246F1F9F190EA46361FF001AF2BB8866D0B5A68CB624B493191DC511EA38CAF23D3158DCC6B751AB34730DEA473C1A61183F321FC54D4345A60ACC83E46651EC714FFB44DDE463F5E6A594F5145D4A3BAFE229E2F187DE407E8714589B21C2F13BA30FC41A70B988F56C7E0693B93CA2F9F1769173F5C1A7643FF106FC73469D49698C31467AA2FE54D3027F771F4A057B0C36E0742698603D9A9DD15CCC4F29A93CB61DAA6C8AE6D46E1876346E6F7A4F529019081C9A6ACACDF7B18A360B21FBC7A528653DA8BB0E51060D2E07AD34213149B6905C702686E7B531A63972A30188FC69DD7862587BF340988B6F6AE712DAC2FEE56A19F49B09324DAC78F40314AFD49B58AE7C3DA6C9C089A33ED83FD2992785A1886F86753F55C114D4AC1D484E957311C4576E0FB31C50D69AB20C89F7FF00BC735572EED11997538FAC7137FC03FF00AF482F6E87FACB266FF7180A2C8A5206D4E35FF596F3C7F519A55D52CDFF00E5B11F546FF0A5A969A6AE48977049F72743F8E3F9D4A32464107E841A0571A5B1D68DF4AF704EE26FA4C8F5A631A47BD287997EECAC07A02451642643346B37FAD8925FF7D735566D2B4F9410F6518CFF00CF31B4D3D85AA2A4BE1DD39971135C427DDC30FE5559FC35201FBABF89BD03230AAB94A4FA8CB5D2750B59BF7AAB2427AEC71C7B804FD2A7B985D622483C7714D6C17D4A210CE4A038CFA8FE957EDAD4AC4AAEE485E00AF5B03462939322ACB9B4482EAF60B4E3219FFBA0D64DCDE4B70D976C0ECA2AB1359B7CA8718D90DB4B79AF6E16DE05CBB7E407A9AEEFC3FA65BE9707C9F34ADF7E43DEB0534A1A984DB94B97B1A52DD22212CE1140C966E82B94D6F5D93503F67B5765B31D7B799FFD6AE5D64EDD0E983505CC47A45AB5DCE21810B103A28AF4CF0C786134F459AE955A7C642E3843E95DB1D17333826EEF951D1952AB9032696CE28ADA4697602C47EB52FB9AEEAC559ACE5D60F9B3911AA64851FCAB0AE2668A66861FB80E0F1D6B9649A3552BEA3F1FD9C43A3062E3029A90333FDAA5E236E40FAD1D6FD81ED6EACACF65723FE5893F420FF5A81E2953EFC4EBF553593D199A9221700F51F98A68503EE8DBFEEF153628945CDD2F4BA9BFEFB34BF6DB91FF002D037FBEB9A43146A528FBF146DFEEE57FC69EBA921EB6F22FFC0C1A09E55B8EFB7407AB32FD4135C6F8FF00439B51BC9356B2789D367EF10FCA473D79EBD684ED2D41AE57CC74DE198960F0DE9C8B7092FEEB3B811DFB75ED5A0C4F424D3934E4EC4EAD913430B7DE891BDCA8A8CDAC27A205FF00778A904C61B384F4320FF810FF000A63591FE1940FAAFF00F5E931F3119B49074756FA0C535ADE603EE67F11486A64462954EE78C8FD6839FEE1FF00BE69741DEE2AC8EA387603D8D384F2E7EFB1FAF348A4AE3FED327A8FC452FDA0FA0A5625C45138EEA7F3A5F3568BB41CA22B03DE94953DC5325AEA34C68DD554FD451E5AD3D013B0D28334797E8696E55D879645215342D50D30008A51482E1CE78A5E94031DEF4EDBC6690800CD2F34AC31E8401CD2313D8D0088E8DD8AA1A424AFBF9C9FCEA26CFA9FCE92434EC319723A9AAD2D85ACC732C08C7D71CD30D0AF2689A73F5B73F811FE155DBC3D66BCC7BE3F7047F855298598DFECAB88FF00D46A93A7B331C7E94D6B7D5E31F2DFC727FBE09A5743BC90D0DACAFDE8EDE4FF00757FFAF40BEBC8F89B4E27FDC900A340E6EE39753539CD95CA7E4DFCA946AB643EFC92467D1E261FD2A8A524C912FAD1C7CB731F3FDE3B7F9D4EB890651D187B3834FA94232E3EF0A6ED53CE282771A554D26D20E4120D5583A11C91973963BBEB50C90641186C7B1AD61371D89D7731EEF488635FDD99236EFB8E7FA55092C675198D83FB15DA6AD3E614A4D3B58E93C3BA7CB64BBDC856618600727EB5D0C51CAEA0C6339F7C56D277335B5D9CCF8B2EAF9351974C9D3CA8A06CE14E449EFF004AA9A7DACFA8CB1DAC2552494ED5673802B382517AB34A9AFC8F5FF0A7852DF42B48D57CB96E31F3C99079F6E6B7C44CBDBF2E6BA1D4527A1CD04D7BCFA86768A4FBE09CE07AD2DCB20FB5497405B5AE554756F51FE15535BB1B6B1B5F323F9A67FBC7D3DEB195ED766917795BA232ACE0597735D138FE1C9EF54F58D6AD34D8CA6A57296D1670A87966E7B01CD61525CA8D2941D491B048233B97F3149B8E30188FC68B9C5E444E88FF007D15BFDE19A81AD2DCFF00CB08C7D1714B42911B58407B38FA3542FA727F0CAC3FDE19A4CB52B6E42DA74A3A4D1B7FC048A8DAC6E07450DF4614B61F311B5B4EBD626FC39FE5513A1C15746C1041CA9A92DB323C3882DE3B8D31C7CF68FC6475538FEB5AEAF227DD91D7E86AA4B5D416D71DF689C7FCB673F539A70BCB81DD0FD56B3DC2C9EE28BD93F8950FD38A70BD5EF137FDF42857427143BED711EBB87D452FDA213FC7FA1A4EE2701CB2C67EEC8BF9D1C37F103F8D1725A1AD1C6DF7914FD4534C1176451F418A2E426D0D6B68FDFF003A67D99474634F4294DEE21B73FDF1F9537C971DC1A2C995CF70D920E833F8D30ABE7246290D4AE2EE228DEDEA6958D3402E6956434BA8243BCD3DE8F301ED40B9450C28DC0F1409A1462968DC56B0A2973430151B146EC54EE0842DE94640154D0C6E78A69349218D269A5B1414AC377D2120D08561322938F5A6161A40F5A614069A1DD886302ABCF6EF28C095547BAE7FAD1CA98AE4096B245CF981BE808A6C90CCED9625BEA6AAC24FA1565B30ED86810E7D541A69D120DBE632C3FEEA260FE754B445D97404B109C453DCC3FEEC840A73477B18CAEA931F40FF0030A15B60771A25D5179F3AD24FF7A320FF003A6B6A77319C4B044E7FD8257F9E6B574FB05D8F5D662C7CF6732FD1D4D3D754B46FE275F6643FD2938B41748952FE17E126CE7B608A55485CF48C93DB8CD56DAB1DD5B4659B5014ED3C63A56CE9E8CA71D41FD2B58EA6321BE25D120D52D1271086B980E78382EBE9FA935CC45616F2A02D19084642FA5449A4CB4D93DBDAFD9B8B79E78C0E9B642315A097FAB4200875ABF503B198914AFD4ABB271AEF8957062D6E5C8FF9E9961568F8BBC4EF1F9725E5A3AFF77ECC707FF1EA39AFA0ACBAA27B0F1AEB76BC49A7D93E79DD182A7F9D6A5A78BA1999A6BDD3998E32DFBD181F5C8A252B6B70E48CB45A1CB78BBE23D9B318F44864F341E2476CA2FD00EA6BCF750BFBBD4AE5AE6F6E1E799BF89CF4F6158C2377CD23A67CB05ECE27B16D0A72A307D4714EF3A65E934807FBC69DCE2D84FB55C0FF009699FF007B9A5FB64DDF61FF0080E296BD05A6E02FF1F7A13F83FF00F5A9C2F623D43AFD79A3527935B87DAA03FF002D3FF1D34A2688F4914FE349B1B88BD7EE907E8690B374DC7F3A6EDB12616ACAB63E24B3D49C0315D8FB3CA0FAF2735AD25AC018A9863C838E06287B2296888CDA427B30FA1C546D651F62E3EA734857631AC9BB4AA3EAA6986D641D0A9FD28D06E637ECD37F733F88A618651D50FE1CD22B990C2A7BA9FCA8C0F4FD290D3143B8E8EC3E869DE749FDF6FCE9343B0BF6897D47E22945CBF70A7F4A5D05CA85175EA99FA1A5FB4A9FE16A2ED13C8805C47EA7F2A5F350F7A5762E5B0C2C3B5008EF4CAB0EDA8DD851E58A64EA80C629A62C77A06A4C4F2C9E869C108A564098B8348335255C5C914F001EF437D4131A73EB46E34C6C3751BB346E161BBA937668D42C34B8149BD68B8EC27CB47CBEB4D310D2A0F4349B07AD3D077637CBCF7A4F2C8EF45849D88E58DC8C0350F95367EF1FCE8B0730C659F1D58FE3519370072A7F9D162AFA0FB7123B6641C0F6A99E31B4907B536C12B957CC1D08A64AEA3AAD525A8DA219268D5724115518DB39CF39FA1AE8A69A7714969A11BA5BF772053E1D2D6F103AEF319EFBB19AD6EF7327CC8D68ED82208FECC360E80A66AEDAC166BB59F4A8988FE211807F3C54733B93C91682EE351299238CC68E72171C03E95774D9F2A13B8A49D8D1EC6CDB10082707EBCD63EA9A358C176642668619D895F2C8C29F4C62AA56B6A257BE843269FA4C6BFBBBBBA66FF6BA7FE834A9A65995DF25F4AA3B614564A57D4A7CDB0DFECF566C4777F2FAB47CFF003A1EC4270B791BFF00C008FEB426815FA957589ED34380C9777D0C937F0DB479DE7EBD702B89D575DBDD53E591BCA83FE78A70BF8FAD64BDF7A6C8E98DE9C6FD599D49C9AD0C8F7E6B687FE798FC2A27B388F4DC3F1A471293216B2F4947E2BFFD7A8DACDC74756FC314AC69CC44F6D2FF00741FA115134322F546FE741698C60C3AAB0FC0D3300F6A9B00D2A076029C24957A48E3FE05498CA5AF472DF691343BC974FDE213CE0822A5D2F599B51D3A0BB6D9BA451BBE5FE2EFDFDE84AE85EA5AFB63F7553FA53BEDABDE26FF00BE854EA164C3ED687AAB0FD6945C447AB7E869EA1CB7144D19FE214BBD0FF1A7FDF42926434C5CFF00B5F91A6B007AF3F5A3726D619E4C67AC69F9534DBC67F840FA500EE21B68FDFF003A61B65F53407331A6DFFDAFD29A6DCFF7C7E5468CBE77B08606FAD37CB61D452B6857306D349B4D4A2AE280C3B9A5F9FD4D343B8A19BBD2EF349362D18A1CD2EE34C5CA8371F4A3752172806A338A1A0B016A334C760CD27140B513029368A63B8D64CF7A4F2FDE8B5C7713CB3EB48508EF4AC90730C31B67228DAF472A0E60C3D3487F7A6D0EE86C864DBF2E73443E66DCB8E690B42291A6070ABC7FBB52A03B46E1CF7A68A695C76053719A2FDC2D72ACCC1242B8A86495075535A415C1C55CACD2DB4995F2B3F551FE34C93EC683FD5A2FD16BA1269194A29BD4B56DA4A5C2091E0183D03715A9F679514657000E29C9129F520B8BAF20AAC8C06EE83BD5FB392EA3C79614E7D47FF5EA536CA7E65B992EEE632B2C208618CA8E7F9D6632C9657277295643822A6C546CF4372D245750C1B356FCAFB52796CE02F51919E6B5B316DA99D1ECB777F3F4B5924462A7A0E47D41A087B93BC69011076E3FC2B395DB1BE54EF723BBBCB1B2B569A6B08AD625E1A5665E7D860726B90D6BC708F1341A3DA79049E6E6521988FF00646062B095E4EC74420A31536723248F2CAD2C8E5E4639666E493499AD168AC436DBBB00A4D4AA98EB55B08F75FB4FAAFE4693ED2A7AA91F8D677673B8DC433C67F8BF4A432C67F887E3C526D828B42641E4107F1A4CFBD016D04C9F5351BAA9EAA0FD453DC08CC111EB127E54C36D11FE123E871482EC635A45FEDFFDF558BA55B2D8EB77FA406C47933DBE79E09C7F4AA8B5B0F99B7634CDA3FF00CF45FF00BE4D34DB483D0D407358618251FC1FA8A4F2DC7F01A4352434861D55BF2A4C0F4A2C5DC31ED4A1DC74661F434805F35FFBE7F3A5F3E4F5FD29585CA980B893B91F952FDA1BD01A9D50B95009F3D452898775FD68BB0E55717CD5A42EA69DC5CA378EC695714C1AD077CB4BB41A2E4D988517D28D83D290EEC360A360A4D85C42B46DA06986CE6822931DC695A36D3E83B8DC1A610D9E284B52AE1CD21CFBD0D0AE861DFEF499707BD21DD01771EB49E6377A2CC7641E630349E6B1E686DAD45641E69A04A4F514D37B0590E0F91D28DDED4EE3E50C8A32284C121A7151CD22C60673CD34C2C557963C176E2AAB5D4327FCB3623DC56F18B64BB8C32DAAE1445F31E802726B4ED7476661218155C74CF6ADD45ADD9CF2D1D91A423960E77FCE3A15ED542F6EDD5CA3CACCDDF9CE2B06AECDD6C67F971CB21918658F722B4F4E9E490F951CAD98C647D2ABA588B72ABB35E06BD6E04BF9E2A2BEB1B896369988631A8E87A8F41F9D572756353F22AE9B3F9720889F94F20D6FDB48A288B63920D42CE6BBC4F0B88B6FFAC73D31EBF99AE5FC47E334D18B5AD86A02FAE01DA4C44AC69F8F7ACEBDD3E55BB36A3052F79EC8E0B56D6350D626F36FEE9E623EEA93F2AFD0552ED5318A8AB22EA4F9DDC41934F4426B4BE8677255502A6B2B5B8BEB816F6B134B21ECA3A7D688AE664CA4A31BB3DA5A27FEE9A8991BD0FE559DAC657B8C34C22914348F6A4DEC3A31FCE8DC2E279B20FE36FC4D1E7C9EA3F2A1A189F6990765FCA97ED5EABF91A916827DA81FE023F1AC7F124C2D67B1D5A31CC126C94FFB07FF00D74D69A8ADD4DA79E12E4A3E549C838ED4DF350F4614B5EA268372B7461F9D1C7AD3B8AC19F7A6900F5E7EB4B41086343D514FE14DF263FEE28FC2913A8D30AFA534C09EFF009D05A9B13C81EA693C8FF6BF4A340E67613C83FDEFD293C93EB43486A5713CB346C6A4F42B984DA452ED3487717069402281A1C01A5E690362F34B8A57245DB49B6A6E0056936D09DB71A5A015A6E2AAE3B0D27DA9B9A61610B0A4DC2973028DC6EF5A42EB45C2C2798B49BD69DC7CA34BA52EF4345C5CA2663F6FCA943463A536C5CA00A1E8697E5A1059887149C5171AB86054172136E5FA0A7B0DDD9559619460A82BE8452456F04B208A2814B1ECAB5B42ECCE5A6A69DAE906D9C4AB0AA483B86E6AC334F1FDD9193E86ADABE81128CB772B31026727D7766AB2C4318C54C504D8E96D9E18965688AA39C2B63834EB7055C3C64AB7A8AAB109335201758565BB9173FED115A096B78C996D4320F6249CFEB4EC93D4A526656A765F64982A3AB291952BFC27FBBF51C53E5F11E9FA4D90B9BF6666270B0C67E673FD054CA5CB7B1BC21ED1A4CE3BC49E3CD5B5B46B68DBEC362492208491B81FEF1EF5CCF4A88C5ADF735A934D28C764266955493576B9912AA63AD3890073C51BBB0B566D68BE1AB8BF54B9BC7FB25A1E727EFB8F615D5585BADB5BFD974B8C5AC5FC72919673F5AD9AE54E262A4E4F9BA2D8ED8D31AB9D995863007A8CFD6A33147FDC5FCAA58C8CC487B546605F534DA1DEDB0C6807634C36E7FBC3F2A4CD1486181BD4530C2FD853D09B8D3138ED55EFACFED76935BC884AC8A46319F7A9D06DDD143C3734B2E94904D9F3ED0F93203D463A7F3AD1229C96A5FA8841E8693A54800661D091F8D2F98FFDE3F9D200F35FD4D1E73FAD21590BE7BFB51E7B7B516172A0131F4FD697CEFF0067F5A2EC395079C0F6A5F31695D8280798B46F5A1DC5CA048F5A4045243487714629DC2D6171462824296A0770E68C9A121864D264D1D4604D34D16D0771319A6914EC34EC34AE69A568B20E61A63149E5D5215D8D31534C3EF45902930F27DE8F27DE8487CC2797EF4795EF4ECAC0DB61E57BD382628B24170DB49B6862B8878A6347BFEF0041EC6A9EE55D8C5B10EDF22B9FA76ABF670359A93145B59BAB1435A2BA5A116BBD459AEA655259C01DF8ACF9AF3CD3B77EECD2D6E57A0D11843B471ED5760D36E1D55CA800F4C9E6B651B9936EE6A2786AFEEA05334B1C712F2AAC49359D77A73E9F3B452BA36DFBACBD187AD3715108C9CD8C895A46C16C28F53C55CB7B2833FBC9901FA81FD69592DC1B7D09E4B2D3FC9643332B1FBA41CE0FAE07E5F8D713E33D2E6B8B68AF234CC96C0A4C83AE33D47AF268934CDA0DADCE3B20F34B8CD416C5005387CBCD362459B2B5B8BF9BC9B58CC927E83EA6BADD2BC3F67A6E26B9DB77743A123089F41DEB44B91733DCC64F9A5CA8D858DEE9FCC98EE07B558CE06C8D7A76ACA4EE5AEE6F976F534D3230A8B75331A656149E71A570B21BE767A8A4F347A51A872A4279AB49E629EF47903426E1EB4848F5A1824264534FB1A40D18AC7FB3BC5AC48C41A9A75CFF00CB4CE7F90AD865EC4722A9EC2DD0C28BFDD1F95218A3FEE2FE54B712637C94F4FCA90C09EF498AED08605F7A6F91EF40F9989E47FB549E49F5A5A14A427927D693CA6A340E60F2DA8D8D4AC35341B0D1B4D21DC369A5DA690EE850B4E152C2E3852D2B341B8F502940152F710A00A5DA2A5DC760DA3D28283D29DC121BB07A526C145C2C3760A615A136558632E29873549B10D24D3096A63D06966A66E6A7CAC7A012D484BFBD36AE3D032F4997F7A1213685CB50375317321FC9A439AAB0AE86853D4D4B147B8FCD9C7B5329CBB1A115E456D1EC8A1718EFB80AAD71A8679F2CAFD5B355CCF7255919B7523DC1C16217D01E2991C00300AACCC4F000C926AE3721BEA68DAD95D095585BC9E6678056B622B3D5A221E489A33D465941FE757676D49528F52758B5EBA623EDD3228FEF4B81FA54579A1DF5C7FAEBB59245E85B24FD324D3E4D2E3F6DCDA2461CC8D0CAF0370F1B1561E869F0C36E7995941F4C8142496A37A688D083FB31507EF093DC609FE955B53FB3F98B2DA6508043803008EC7EBC9CD26EFA58211B3BB6717E20F0C894CB79A6285600BBDB01D4772BFE15CB039A4D686A2FA63249E001DEBA1D1BC2F35C849F51636F6C79D83FD638FE95704ADCCC894DC745BB3A281A2B4885A69D6E215EF8EA7EA7BD5CB5B53B4190E4D4B937AB04B97DD45BD991B7B5491463A28A8BE855EC6E345EF51B467348E74EE31A36A8CA354969A1854FA530834EC31A734D3523B09CD349C5025B89B88EF49B9BD4D03BE865789A192E34D12C7FEBAD5BCD43FA7F226AFDA5F9BFB58AF15B22750FF9D3E82B1279CDEB49E737B5482483CF3ED479DED49DC1A4C4F3FF00D9FD697CFF006FD68D4145079A3D28F3568D44A01E62D1BD696A1CA1B87AD1BC7AD098583229323D681585A290EC14B468160A280485E6804D46FA8D31726946EF5A4D827A0648EA68DC4D2B5C69880B1A4CB77AAB21A139A420D0959584869069B8A631314D38A770B31A7149914D583944254534BAD2B872885C527983D28BB1F28865F6A4F37DA9AD507280972718A78AA4BB8349172D2C8C803CBC27D7AD4D2ADBC430A17F3CD69A2252EA50BA9D235255771EC0566BB4F33924151E80D0B5093B6C4890B9F957AFBD6BE946DB4F55636ED25CB0E642E063E9C568E76D886B98D487586B56DF1DA8793B1625B1F9538EA1ABDD9DFE40DBDB6C071FA9A494E457B91DC7249AF4842425E207FBB84FEB4A6C3581F34B7EEA4F6F399BF91AB8D3BEAC97592768A29EA9A15E476736A5E724C5482E318272719C93594883EF48DC53E58C44A4E5AA2DC3259A1CB02EBE841356BED5658F96CF3C1192A314B99F42B953D598D731B5A5C6212EBB79898F04AF63595E25F0EDBEB4EBA8D8BC76B7323133C6C0ED724FDE181C1EB9A2D62EFD50695A45868C04898B8BB03995BB1FF6476AB5BA7BB90FCC7DF3D289CB9DE9A242841C6F27BB2E5A5AA4038EBDCD5AC81C0A86EE68B4436597C94DC413E8054AF2B476E0F427AD16D07A2B1BECC3D69A4D4F3239521A4D309A0A6869A690295C43180A6951E95250DD8BE94D318AA0630C4B4D318A570BB1A6153904F0460D6368117D8AEAF3462DFF001EC77C59EE8702A97542BD99ABE59C75A431354BB5EC0A437CB34796D53D4A5213CB6F4A4D8DE940F9836B7A526D3E94AC2E64C307D28C1F4A18EE83068E695AE1741CD2D03E828A519A417169C0D2E831453AA45D070C528A57D04870C52F150340081DE94E3DA8B0EDD4323BD212BEA287A8C6E5698C47AD16631848A6362AE370B8C34D2334EC2B8D2B4DDA6A94439AE34A669A63F7A76173079749E58AA5A873310A0148141A3616AC7A20C80A324F6156D2D2551974C7D48ABE5BAB937E824A31D40AA37370B17DD5DC7DB8A2CCADC8048D27CC5719ED9AB1A7D9CF7F2ED8CAC5129F9E57E3F01EA6B48AEE672D353A1834ED3D30B9882FF133480E7F5ABBE7E8367F2DBA4123FA884B1FCF14DD4EC2F6726EEDE8116AD65112CD6B237A2A00BFD29B71E2579BF77159BAA8E81E5DDFC854A936AC8A54E2BA907F6BEA64E208A207DA02C7F5A9162D7E7FDE4B24A99E799427E99AB8C1CBE20728C34439747D4EF5C2CDA8B6DEE1D99FFAD656B5A33E9776A9F6949A27518230083CE475FA5538C61B92AA39E8915637815B6B293EF5760D4618536C768D9FEF0703FA52E668BE44F529EA9A80B945F3422A46C587AE48C1E7F0AC892EDE53B6018FF68FF8542BDEE6B651D51620B4DDF339639EA58F3572389625DABC0F4A52B740D5BBB1E0134F0A072688ABEA0DE83256DDC63A50C77A153556B224DF34DE6B2DF532430934DDC68296834B1F5A42E68B8AC34B9A69928DC62799ED4864A186837CC149BC52BB0B0D2E2B1B5D7163A8D8EAA99FBDE44DFEE9EE7F134264DB5B9B2EC818ED395CF07DA9BBC7AD2E67D4761370F5A323D695C560247AD2647AD1706BA8714714F4252B05271EB4876038A4C50160A29157B851420B852D200A5CD16D060334026A4487734841A061C9A501A9790C36B7A526C63CE292EE17176353763509809B08A465CD36C761A45348A77B8DA1A698C715570B0D2C69A58D21D908E4D464B7BD520BA136B13934F58D89E2A84E4685A9B7B550DE533BE3EF64513DE33745C0F739A6E4D8AC92294B233F1DAA1744DB96C629A77D092D5BE9376C017B66543D376066B563D16F648944823891471BCEEE3E82B6F677EA66EA12AE90DC279D11FA467FC6AE47A2D9C4999E5767F4F3420A518A8ABB0E793764462DF4C5CF9F244AA3FBCFBFF954AFAAE9B08F2EDA104FF7A28F67F3147B4B688A549C9DE4C67F6F2DBAEE8EC6467EC5E5047E40544352D6EF98B4506D4FF62123F5268B4A7E83B421BEA2B5BEB5723635D4E80F1CCDC7E40D483C2EAB1992F2F7A827E5F97F526AD4231576C9F68E4F9628E6E58D2D5DA22EB234676970783EF552EAFB602A172C7A7A54377D4DA30E5D1949E19AE7E724C8DC614F6AD1B1B11026598B3139F4C7B50DD903DCB6381814E0A4D422D8ECAA530B93568813340A7B311D19514C65ACB43052B2184530A5162F5630AD34A9A02E34A9A610690D0D39A69069D8131A4534E4524C77BEA34D57D42D56F6C66B77E8EBC1C743D7FA52F30654F0EDD3DD693189B3E7C1FBA901EB902B40E6868A10E692863B0673499A926E19A5C9A06193EB464D1B821326972690064D2E4FAD0C2C1934A0D21E82D2D2B89214528A49DC070A518A4C070C52E454B43B0B90051B97AE692BF404AFA8BBD7D69BE627AD4D98213CC5C527982A927B0D3446D20F4A69707B5528B0B8D269AC6A92B0AE37AD348E6AAC0D8840A69C5021ACC01A4DC29A61626B780DC1001DA0FF00111565ADD215C17DC7D718AD2DA6A4EECAB3CAA8393554C8CE73D05091571F182DC62B5F4C1A7D9C6279924B8BB382171858FF0031C9A71972EA438F369D0B8DA9A16F31ED99DBFDA907F85473EBB7D73844586351D96324FE749393D10F9631D444B8D4D862296E158FF73294ADA4DF4DFBCBB957FEDB36F35A469B7AB14AA25A2258344F3980695557D5531571F4ED26CD76C8559C779240DFA0AB6D437DC8E694DD90C8AEF47B66DE515B1DA384E7F3C536F3C50D237976F68C076F31B77E8054BA8E4ACB42A3492F7A4529F5AD46356267487B131C7B48FC6B16FB529AE4FEFA79A6FF00AE8E4D65AB7A9D51B456851926C29278A4B781AEF0FC853DEAD776437D8D186DE385708BF89EB52804D2DF512BA43C055192691A5F4ABB088C93DE9285B098B9A5CD007484D309151B98A5A8D34D26A4686134D34728C69A6D3DC2F7634D21A431B4846690AC3714840A2E1D4C60DFD9FE2975236DBEA2BB9476DE3FFAC2B5F68F4AA6AF60D6C842ABE949B47A54D87D04DA3D28DA3D292D494D86D149B4531F35C368A368A4D89B684DA29768A4D0D30DA28C0A0770C0A30290EE0052D020E6806958032697349AB8C72D0D53D463714B827B5390C50A7D293637A52041E59A5F2CD26D0598863349E5D3E61D869414D2314D30B0DC534D176318462984126A9216826CE7352C310072C335695B513974277B96C05F9401D302ABC93B13CB13F8D0AEC3A1037CDC9A5542FC0207B9AA44B36ACF473210B1CEAC1B90C13B7E7579B48B5B6037C92CB267046EC01F856CE318AB9973B6EC396C6CA3413DD18113FE9A3027F2EB546F7C491C6BE4E996D12281F348CBF7BE838ACE7356B44A8C35E7919835ED615C345771A81D018B3FD6A71E22D464C2DC491B7FB491E0FF003A3A16DC5BD8B904DA9EA0BB2DEE6E194F5025DA07E1522681246DBEE2E61DDD70A858FE79AB8D3D2EC9F69AD917A3D22C52233DE4A442BD4BB800FE1599A9F88ADADD0C1A25B476C83837254076FF007475FC69549A4B963F32E941CE5CD53639BB80F773A4F2B484A6482CD9273D69FB0118EA6A76356F51F158AB1DD373E8BDBF1AB83D00E28625DC785C72686940E95695912C899CB52535B085A5A2C160EB4669EC26CE8DA986B0B99AB0D34C6A06869A4268286134DC9A760109A696A901A5CD3779EF5561210B1A42D5256865F89227974E13C20F9D68DE6A1071E808FCB3576D2F52FAD22BB8FEECCA1A9BDB415AE4BBE937D48C4DE68DF40AD60DF46FF6A43B06FA43201D481F8D009086651D48A43708392DC53B30B09F698C7F17E8695650FF00741FC8D2698AC3B71A5DD52EE3EA00D19A61B8B4B4B71DB416940A9D6E21452835202E40A5DC3D68B742837AFAD1E629A5663D04328A4F347A52516C6DA1A65CF6A6191AA947B937EC3779C534926AEC26C4CD34D34034D392367385049A6B716DA9656CD55773B927D00C5432B22F4AD74D81229CB216385E2998C0A436C5CF14E490AF14226E8D1D3F58D42D2DD6DADA68D1013B488F2FF9E696EA7BA8C79B7535C6642701C919343BBD470E58E863DD4F199373AEF6FCE9A9213C91B455422EDA933B3177EECAAD3D0AC633D5AAD3B12ED62D699A9DFE9F7065827215861A36E50FE157AE35ABE6CB4974549ED17CBFD6A26EC8D29995777525DBE6595E623A798C48151C7182DB9CE5BD4F6FA54A37913795BBA54B1C2A83A734CCED764817D68DCAB549680D8C6909A6E6A897B8B4668B06C3679A3B785E695C24718CB13D8545A7EA369A8A33DACA1C27DEEC453D4AE5F73999673464D3E841D29F7A61AC4C869A8CD340FB8D229A4522B71A69B8A1BB0C6914D22905C695A6D0D85EC21148450900DDA0E430CA91822B1FC3C86CAE2EF47738F20F99167BA1C0A6906E6BED349B4D48EE1B4D26D34FD42E1B4D5AB0B7B5672F7921D83A2283C9F7A96EDA89DDAB23510F87D7EF5A44C7DE027FA54AB75E1E4FF9728BF0B61FE159734C4A92EAC91752D01785D397FEFC81FD29DFDB7A3C7CAE9C4FD2351FD2A39A657B280D7F11D80185D3A5FF00BE907F4AC8D4F5392F7E455F2A11FC19C926A92937A828C62EE8CFC629715A8AE18A295AC3B8A0F1464D2D82FA0A09A4DC6801726806930B8734734C0306976B7A54DD0C5F2C9A4119A5CD61D98A53DE9360A398761360A420517771F28C38A66477AA41B0210ED8156BCC10AFC8AB9F535A2D112DA65696E646FBC47E1C557672C79A3627723678D4E3760D359B8AA0B58AAD7C598C7127CC3F89B914C7BA789774841F65E2A92EA271D4B961792068AE63528CA4300D53788750BAD5AF7CF329031F2862485EB434BA87359368A10C3B065DB71FA53D9971C9007B9AA722637645F6D854E118B91D401FD6A5864F339DA40F7A567B95CBD098CAABFF00EAA61324A7A951E953EA6B6B2254888152C7011C9A4D83B9615714160B56906E46D213D0D3739AA130A334EC21734B405FA90DEDB25EDA496D21F924183F983FD2A9787B46FEC68A54F3FCD32B03C0C002B484946FA0A577A1A82909B86C74CD4C358EC6434D358D4DF51A1869B9AA296E349A69340869A426A7A0C6B53298582928B89AEA21AC5F1006B2BCB3D5A3CFEEDBCB9BDD7FC9A6B72977369B19254E549F94FA8A4A9BDC5D429090064D21581483EBFF007C9A787FF664FC10FF00850C77D2E3977633E54A7FED9B7F85382C9DA197FEF8349C44E487793707FE5DA6FC50D365492203CC4299E99A5648699033669B9AA1D83229335216173466801334B434161452E2A772AC2E2818A4D00B4B9148685DC051E60F5A9E5BEA3B89E68A6997DA9F2B0B8D321ED48646AAB05C6EE3EB49926ABA9371304F4A8D079CA5908DB9C67D6AA2AEC964A17CB5C66A09666270A326ADC6C52D8680719279A43CF5A8B8B61AC8ADD541FA8A6C91861EDED549EA26FB107D9E28CE55704F34A5513E7F94103390326ADCBA9166D95C6A1013FBB667CF7008FE7504FAA043B1146F3D371C8A5AB2AC9021BD90E64720FA27CA29FF00629273F3C802F718C9FCEA9F2AD87152DC9A3B3B6B7E30CEDEE69F963C76EC0741F85272BEE69156D495133EE4FAD598606EAD53B86B72758C0A52C1455242236949A8C9356174C28A360BEA2D14DAD4916969F903D82B335FD6868D1C4C61F34C87FBD8C0C527AE85C2377A96F4DBBFB6D84376176F9AB9DBE9533B7156D59D884F53A86A61358346371A4D3334B618D34D2695CB19D4F503EA714D6201C161F98A571A426558655D0FD1C1A61346E3133494C42669B46C17026A0BDB64BDB496DA4FBB2291FD7FA50C0A1E1AB9925D305BCE4F9F667CA901F6E95A79A72DC60373305552CCC7000EE6BA2D1B458EDD7CEBC0249CF45FE14FFEBD4ECAE653D7436512303E58D07E156612A9CE05677D095043E4B803A62ABBDC31E8C7F0A8BB344924666A9ADC760A54334B707A460F03EB5CB5D5DDC5E4C67B8937C8DF901E94A9A72776696B222CD15ADAC0145315C28A02E2D14AC083346EA561DC5DC69371A057B864D1934C04E6970696C21429A0213DE9DCA142734BB454EE3B0DC014AAA09ED4750DB612FCAA5B08A2606594ED2CA7EE2F73FD2A395D111228542C71F0A056CAD6D09F3640ECCFDE9146DA97E64EE2D18CD22AC25211EF4D0AC413A9DB85E4D5282CEE239C4AF3A11CE5003CD5E9BB2926B41E2CA25C617F0ED53470247FEAD1533D4A8C6686DB2F9751CE52300BB75E8A3927F0A8DA467380362FF741F98FE22A56FA17E62A45FC2AB8F602ADC368782C462AAFD599B772CAA2A714ACC0516BB0B5889E53DAA32E4D6895C5A084D2D3F22760EB4B4343D85A292EE0EE2E68AA42B866A3B8B4B5BB50B750ACAA3A03DA90AF608E3482258A240B1A0C0007414C77C555EE0A36D11D6934D26B06CC86134C268B1772379028C935527B82410AC54F62293DC96ECCC9B9B4FB49FDEDEDE9F613F14C5B2648CC697D78AA7AFEF735B24AD6B09D49BDD95E3D26385D5A3B9B9054E47EF2B612EF6FDECD26BB0E3376F78945C46DCE69E2453C835934CB6EE04D252B0C29B8A2E0635C1FECDF13A4FD20D406C71E8DC9CFF2AD923048EE29B69A42BF726B3BA7B393CC8950BE31B99738AB635FBF1D3C8FFBF7FF00D7ACDC6EC128F517FE121D4FB3C2BF48FF00FAF4D3E21D5BFE7E947D13FF00AF52A9AEA52E55B0C6D73556EB7EFF008647F5A85F52BF93EFDECC47B3629AA690F9CAECC49249249E493D4D2555896C28A6D682128A2C014526160A28652414520B05380A4C120C0A5E050CA5A8A08A370A8487B06F14DF300AA485A0D321A4DEC69D82E0371A5E955615F52AACC927CEA410DD08EF526C3D4D3D90AD71B8CD285A91D830283C5329223634D2698EC3491EB8FAD4524D1A7DE71F8734CA4988B2EE52FB76A0FE36200A63DCBE3F70A47ABB8FE4BD7F1A6C57EA356325F77258F19272DF9D5C82C5BAC8C00F4039FCE8B2DC96EE595F2A11851F80A43233727007A538ABEA0B41AD2D46589EA6ADA13EA1494D1219A5CD3B21B0CF14BDA9B565713B06714EA96EE1A8519AAB12DE82D231C0A0696A72DAE5CEAFFDBC56D59D61DC0461781B6B727910BB6D3F2E7834F979527DCD1CD397BAB63B334D3581CD1446D54751D4AD6C5CC73CE1241D5704E3EB4A4DA2D2B99DFDAF6121FF008FF8893D0124535B51D3CFFCBF41F8B62A9DFAA23977B909D434F079D42DFF0016A517D60DD2FEDCFD2414DC9AB68270627DB2CBB5EDBFE320A6B5ED8F5FB7DBFF00DF62926FB16A936855BCB323E5BEB76FA480D1FDA366879BE83F07A1B17B368920D62CA4E9771903B93815A11324ABBA396371FECB8352DB348C5ADC53484D4D8451D76D0DF697244A712467CC8CFA30FF00EB53B48BFF00ED1D320BBE8CEBF38FF6AA96C0B62DD26686019A338A9D8A0CD2669083346698D099A33402419A4CD200A07145C05A33490C29734C626EA37516D041B8D1B8D204C4C9A33409860D2ED345C690E588B1AB5159478DD2927DB3815714B725A6F4192BC29F2A220FA0154AE5A578D96151B986013DA8BF72B96C8669F671D959C3046A4796817939FAD4FE5E4649A1BBBB8D2B2176A01513301505588CBD4525C469F79C7F3AA5A956B903DEA0190ACFFA540D772374DAA3E9CD3B30D10C4135CF0A4B0F563C0A95228E11DA493FBC7841F877ABDB42652BEC382493104A1723B91C0FA0ED56A1B4E732163F53CD4DD6C26FA1691523076F19EB492B82319C5341B109703814D2C7D6AD10FB09466AAC3B851459EE02D149A0141A5AA15EE14668B0DA1452D316C84CD31DB149815669CE31938AA32C983551296C7A19A61049C0AE7472D8C3F11F88A1D2D1ADEDA4592F5B8C03C4631D4D70B7255E46964FDE48DC966E49A74D36EECDD2B2B15A4DAE30CAA7F0A81E24FF009E6BF955ECAC45C89E25FEE2FE54E58E3C7DC5FCAA6F7D4D3702887A22FE549E5A673B17F2A6EE17EC27969FDC5FCA9C15010422FE54BD45624211860AA9FC292167B6903C2CCA4306C2B601C50546E8ED6CBC59A6DEB1F3F7D9C8CDFC7CA9FC40AD8C820152181E4153906B369F506ADB099C562E9DFF0012CD7EE74EE905C832C1E839FF00015717D095B9B34545EE3DC28A002929582E14629B561730514AC17128A2C0D8514F442D4292900B45035A0518A43B06297145CA48381D4D2191077A9B8EC37CF5EC09FD28F3CF64C7D4E68E5637B8F4B89872AFB7DD462958CB2FFAC95DFF00DE626AC10AB1F14A555464B01F538A4C376466E6251CB0AAF26A308E87F2E7F95166348AEFA8E7EEA16FC71559AF2663D540F614F61B69113C8EFC33123D09E2980E3A002989B1635795B6C6371AB315AA4793365D873B41C01F5AB7A68459BD07066B81B2142C3D40F907F8D588AC7806572C71D070A3E8284EC83C9169556318000FA52338A4A371F4226939E2985B35690AE2514F625B03451B8C5CD1F5A7610514DB1A76169696C2614534C371D9A4268483A0D66C55799F8A2FAD82D7284D21E9DEAA4F2EDAB5AC5B46B15A1E9649EF54AFA7FDD3463AB0C573AD7438DCBA982745D30B976B40CCDD589CE6A16F0FE947FE5D481ECDFF00D6ADB9DA5630716FA91FFC239A4673F679BE9E6F1FCA90F86F483D6DE5FA79BFFD6A7CDA5812977236F0E68F9FF8F7947D25FF00EB530F86F491D229FF00EFEFFF005A85268AF7EDB89FF08EE95FF3C67FFBFDFF00D6A43E1CD2BFE794FF00F7FBFF00AD53706E76B5C3FE11DD247FCB198FD66FFEB521F0EE959CF932FD04BFFD6AAE664FBEFED114FA169F1FFAB81C7D5F3FD2A38749D3DBEFDB6E3EED9A1482D26B72D268DA663FE3CD3F1AD1B0D9668228942C63A28ED52DB7A32E9DD3BB668AB6FC63BD73FE2EBA8C5DDB5BD8EF9B56B5727646B9D83B86AE7774D2475AB6B26F42B457BE36D56E764313DA8CFCC554469F8926BAB6474C2C8EAEE3EF3290413DFA55B8C22B47760EB466ED15A0DA2A6D7245A4A401451700A3340EC2668CD170133466A585828C8F5A2E52426F0392690CC83BD21A434CE3B0348673D853E5761E837CD90F523F014859CFF11FCE9D90F7D040B9A7AAD318E083A9A3746A70CE28B8B7635EEE18BAB67DB351B6AA17FD58FF00BE96959B2945752093529DB85257DF355A49E590FCEF9FA50A3AEA372488CB31E1896FA9CD1BBD2ADB33BB60CA5537332A8FF6980AA736AB630E733F98C3AAC6A4FEBD2B3BF4897185F57B15975896EE716FA6D8BBC8DC7EF0EEC7E0315A36BA6DC91BF52BD61B97FE3DED9B68FC4D6BC8A3694B5339CFECC3EF2FC6325A2B580019E557E51F89EF53C560B806E08723F85384FCA8BD817645A18450AA0051D00E94D32E2A547B8588DA52DDEA3C935685BB10D18AA6C00D142DB513570A514813B85145EC085A334C2D6400D14C4C5A514C2C19A696A634EE432498AA577791C5F2E4B374DAA334AEEC6B0573224D4C9BC30BC61011F2E0E4E7DEA0BBB8C1CE69C53DCD16FA1EAD75324113C923AA220C9663802B0E5D4EC58E5AFA0FC5AB9EED33CFE572446750B0ED7D09FF0081534DF58F7BFB71EC6402B4BB13A6C68BFB0CE05FDB13E9E60A0DED88E0DF5B67D3CC149C9AD6C254DA7A91C97DA78EBA85B0FF00B682A36BFB0033F6FB7FFBEE92937D0A74E430EA5A70EBA841F4DDCD21D574B03275087F5A7CD712A72236D634A5EBA8463FE02DFE14DFEDBD201E7518FF00EF96FF000A69C9F41FB29318DADE90DD2F437D236FF0A87FB674B53C5CB1FA44D45E5D8D152D3706F1069CBC2B4AC7D76102983C4764872F1CEDECA3FF00AD49B907B24BA9620F1869F13E56D2ED4F3862E303DFA556D2B53B8F0D29B66D305CEA3787CC122B83BD4F418033D41EF46BAABEACA4A30D24F412FACFC63AC82DA95D1B6B75FBC27B811C6BF866B4FC39FD97A742BA741ABC77972E4B36D0719E381EB4938D35CB0D59A294EB2BC57BA6CE68A92185146C34252647AD4892137AFAD2798BEB4F51B41E60A6F9BED44818DF38D2798C6851EE1D3410B37F78D34927AD3B14B503494BCC12B0B8A29D835DC0103A9A479D23E18E0D0524446F947DD1BBF0C531AF5CFDD52BF539A560BA444D712B7561F80A8CC8E7ABB11E84F1556D41CBA0DC28E4003F0A339EF46DB13A0AFF00BB5DD232A0F5760BFCEA9C9AAD8479CDC6F23B2293FAE2A54BA2348C6E539BC429B7FD1ACDB3FDE95811F9015525D6350931898423FE992EDFD68E4BBD4348EC54DB35E4E0624B8909C7396C66B6EC3C30576C9A9C8117B4111E4FD4F6ADD5A3AB30A951B765B9D0DAC02087C9B5896DE23D97827EA7BD4D1DA27F18DDEC7A545ECDDF714534AC8B2311A04E028E8A3A0A8DA603A54DB529B216949A666A9204C33453B5B604C334992012319038CFAD0F61ADCC7D0F50D46E350B9B6BF4FF0054BC10B800E715B34F96C4F32949A419A286BA85C2968B5B51866969EA171334A2826FA8BD68A6021602A9DC5FC311DA5B73671B57934D276D071DCCFB9BA90FFAE71129FE143963F955510CD2F30AFD9D73CBB60B1FC3B55C568D5CD39F5BD8CEBFB510B97123330EE4D542411B98E4FAD45D8D2EACF44F1EDD15D392D141669892C00CF15C149101926DDBEA633FE1514E2DA6D9CBCC9219E48ED6EDCFFD333FE14D3167EEDBB1FF00B667FC2A945BD06A4BBAFBC43101F7A161F543482318C884E3FDC3FE14DC1B1DD0E11023220623D4467FC29A62FF00A62DFF007ECFF854B831A924B71C206232B6CEDF48CFF853E3B29A43F2D94C7E911A6E17139C52DC9574BBC6FBBA7CDFF7EC8FE94A74BD43EEAE9F3FD3653F67DD89548C756C91744D";
//              String start=  "59FA584BF8E07F5A917C37AC374B227FE06BFE350D47AB1FB68D87FF00C233ABF005BC79C7399947F5A5FF00845F563D7C85FAB83FD69FB9D1994AB34AEA37255F08EA0E3E7B9B5507EA6ACDED95E6856F0EB31DFAB5CDBA794018C91F873EF49B46D09B6D3B6817DA36B7AC5AA5F6B7AAC56F01190B236420F602A0D3EFFC2BA0BF990A5D6A3720604F908AA7BE148A98CB91F2D335973D6D5E88EA61BAF3E08E658DA359143057EA01F5A53237AD271B3B322E80C8DEB46F3EB424171A58F7349CF4A012D43A51BA8636EE19A43468C425191DCD030DC29AD22A7DE23F3A57D0BB6846D7710EE7F234C378074898FBEE0285A86846D7329FBBB47D46698D34ADFF002D187FBBC52BEA2BF41872C3E762FF00EF1CD3542A0C280BEC29B905D8BBA9464FF9E29376D47E64571716F6FCCD731267FDADDFCAAA4BADD843D0CB37B22EDFD4D4DDBD8B51EACA93F885F38B6B4451FDE99B77E8315525D5B5194F374D1AFF007621B053E4EE2D1151F32316918BB1EEC7340007005592DB6EEC7C31497132C3046D2C8C7015456EE9FE163959754982A633E444D963F56E7157F0A4D99C9B6F963B9D0DA5AADB2797670A5A467AEDFBCDF8FF008D588A148C961F78F563D4D66E4D8D2B";
//        StringBuilder ssb = new StringBuilder();
//        ssb.append(end1).append(end2).append(end3).append(end4).append(end5).append(end6).append(start);
//          Integer num =66;
//        redisUtil.set("receiveNum", num, 60*10L);
//        redisUtil.set("imgInfo", ssb, 60*10L);
        //获取内容
        String content = data;
        //获取黑匣子编号
        Integer length = content.length();
        String deviceNoStr = content.substring(8, 14);
        String deviceNo = new BigInteger(deviceNoStr, 16).toString(10);
        String fileName = deviceNo+".jpeg";

        //总包数
        String strCount = content.substring(content.length() - 14, content.length() - 12);
        Integer count = Integer.valueOf(new BigInteger(strCount, 16).toString(10));
        //图像数据
        StringBuilder sb = new StringBuilder();
        String img = "";
        Integer receiveNum = 0;

        if (redisUtil.get("receiveNum"+deviceNo) == null) {
            receiveNum = 1;
            redisUtil.set("receiveNum"+deviceNo, receiveNum, 60*10L);
            img = StrUtil.sub(content, 22, 1034);
            sb.append(img);
            redisUtil.set("imgInfo"+deviceNo, sb, 60*10L);
        }else{
            receiveNum =Integer.valueOf(redisUtil.get("receiveNum"+deviceNo).toString());
        }
        //当接收完所有包后再处理图片
         if (receiveNum.equals(count-1)) {
            //此时所有数据包都接收到了
            String str = redisUtil.get("imgInfo"+deviceNo).toString();
            //最后一个包长度不清楚，截取去掉头部尾部，信息体中其他部分
            img = content.substring(22, content.length() - 16);
            //最终图片字节流
            String imgInfo = str + img;
            //等待处理.....
            //二进制数组
//            byte[] images = DataUtil.hexStringToBytes(imgInfo);
            saveToImgFile(imgInfo, ftpProperties.getFilePath()+ fileName);

             // 转发图片16进制字节流
            try{

                if(redisUtil.exists("xywg:sjj:dispatch:"+deviceNo))
                {
                    zbusProducerHolder.sendDispatchMessage(imgInfo);
                }
            }
            catch (Exception e)
            {
                e.printStackTrace();
            }

            //上传图片到ftp服务器
           String ftpUrl=  fileUploadToFTP.uploadPicture(fileName);
           if(ftpUrl.length()==0){

           }else{
               String jsondata = "{\"deviceNo\":\"" + deviceNo + "\",\"url\":\"" + ftpUrl+ "\",\"deviceTime\":\"" + System.currentTimeMillis() + "\"}";
               System.out.println(jsondata);
               try {
                   zbusProducerHolder.sendSjjImgMessage(jsondata);
               } catch (Exception e) {
                   e.printStackTrace();
               }
           }
//            try {
//                //二进制文件保存
//                FileOutputStream fos = new FileOutputStream(new File("D://aaa.jpeg"));
//                fos.write(images);
//                fos.close();
//            } catch (FileNotFoundException e) {
//                e.printStackTrace();
//            } catch (IOException e) {
//                e.printStackTrace();
//            }
            //清除缓存
             redisUtil.remove("receiveNum"+deviceNo);
             redisUtil.remove("imgInfo"+deviceNo);
        }
        //中间接收数据包
        else {
            //接收到的数据包计数累加
            receiveNum++;
            redisUtil.set("receiveNum"+deviceNo, receiveNum, 60*10L);
            String str = redisUtil.get("imgInfo"+deviceNo).toString();
            sb.append(str);
            img = StrUtil.sub(content, 22, 1034);
            sb.append(img);
            //叠加数据包数据
            redisUtil.set("imgInfo"+deviceNo, sb, 60*10L);
        }
    }

    /**
     * 16进制转换成图片 by-zhouyujie
     *
     * @param src
     * @param output
     */

    public void saveToImgFile(String src, String output) {
        if (src == null || src.length() == 0) {
            return;
        }
        try {
            FileOutputStream out = new FileOutputStream(new File(output));
            byte[] bytes = src.getBytes();
            for (int i = 0; i < bytes.length; i += 2) {
                out.write(charToInt(bytes[i]) * 16 + charToInt(bytes[i + 1]));
            }
            out.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private int charToInt(byte ch) {
        int val = 0;
        if (ch >= 0x30 && ch <= 0x39) {
            val = ch - 0x30;
        } else if (ch >= 0x41 && ch <= 0x46) {
            val = ch - 0x41 + 10;
        }
        return val;
    }

    /**
     * 注册
     *
     * @param data
     * @param ctx
     */
    private void zhuce(String data, ChannelHandlerContext ctx) {
        //A55A 60 01 000001  C0 10 CC33C33C
        if (!isLogin(ctx)) {
            String number = this.number(data);
            String sn = this.sn(data);
            String cj = this.content(data);
            String checkCode = this.checkCode(data);
            //校验
            this.equalsIgnoreCaseCheckCode(checkCode, data);
            XySession xySession = new XySession();
            xySession.setSn(sn);
            xySession.setType("lift");
            xySession.setCj(cj);
            xySession.setNumber(number);
            xySession.setId(RandomUtil.simpleUUID());

            //双向绑定
            ctx.channel().attr(NETTY_CHANNEL_KEY).set(xySession);
            nettyChannels.put(localKey("lift", sn(number, sn, cj)), ctx.channel());

            String jsondata = "{\"deviceNo\":\"" + sn(number, sn, cj) + "\",\"deviceTime\":" + System.currentTimeMillis() + "}";
            System.out.println(jsondata);
            try {
                zbusProducerHolder.sendSjjHtMessage(jsondata);
            } catch (Exception e) {

            }
            System.out.println("登录成功 <{" + sn(number, sn, cj) + "}>");
        }
        XySession xySession = ctx.channel().attr(NETTY_CHANNEL_KEY).get();
        String number = xySession.getNumber();
        String sn = xySession.getSn();
        String cj = xySession.getCj();
        // 返回 数据
        String ret = HEADER + "02" + number + sn + "01" + "0F" + this.time();
        String retChechCode = doCheckCode(DataUtil.hexStringToBytes(ret));
        String length = length(ret);
        ret = ret + retChechCode + length + FOOTER;
        System.out.println("返回:" + ret);
        ctx.writeAndFlush(Unpooled.copiedBuffer(DataUtil.hexStringToBytes(ret)));
    }


    private void shishishuju(String data, ChannelHandlerContext ctx) {
        if (!isLogin(ctx)) {
            throw new RuntimeException("未登录");
        }
        //获取内容
        String content = this.content(data);
        //采集时间 0-14
        Date collectTime = new Date();
        //跳过厂家及设备 14-16
        XySession xySession = ctx.channel().attr(NETTY_CHANNEL_KEY).get();
        String number = xySession.getNumber();
        String sn = xySession.getSn();
        String cj = xySession.getCj();
        StringBuffer sb = new StringBuffer("{")
                //采集时间
                .append("deviceNo:").append(sn(number, sn, cj)).append(",")
                .append("deviceTime:").append(collectTime.getTime()).append(",")
                .append("createTime:").append(collectTime.getTime()).append(",")
                //重量 12-16
                .append("weight:").append(toBigDecimal(Integer.parseInt(StrUtil.sub(content, 12, 16), 16), 0.001).toString()).append(",")
                //跳过 重量百分比16-18
                //人数 18-20
                .append("people:").append(toBigDecimal(Integer.parseInt(StrUtil.sub(content, 18, 20), 16), 1.0).toString()).append(",")
                //高度 20-24
                .append("height:").append(toBigDecimal(Integer.parseInt(StrUtil.sub(content, 20, 24), 16), 0.1).toString()).append(",");
        //跳过高度百分比 24-26
        //速度 26-28
        String suduStr = sudu(Integer.parseInt(StrUtil.sub(content, 26, 28), 16));
        String sudu = StrUtil.sub(suduStr, 0, 6);
        sb.append("speed:").append(toBigDecimal(Integer.parseInt(sudu, 2), 0.1)).append(",");
        // 倾角 28-32
        sb.append("tiltAngle:").append(qingjiao(Integer.parseInt(StrUtil.sub(content, 28, 32), 16))).append(",");
        // 跳过 倾斜度 32-40
        // 跳过 驾驶员 40-42
        // 门 42-44
        String menStr = men(Integer.parseInt(StrUtil.sub(content, 42, 44), 16));
        sb.append("frontDoorStatus:").append(StrUtil.sub(menStr, 1, 2)).append(",");
        sb.append("backDoorStatus:").append(StrUtil.sub(menStr, 0, 1)).append(",");
        sb.append(userinfo(ctx))
                .append("status:").append(alarm(StrUtil.sub(content, 44, 48)))
                .append("}");

        try {
            zbusProducerHolder.sendSjjDataMessage(sb.toString());
            //   依据缓存判断是否需要转发
            String deviceNo=sn(number,sn,cj);
            System.out.println("设备号是:"+deviceNo);
            System.out.println("缓存值是:"+redisUtil.get("xywg:sjj:dispatch:"+deviceNo));
            if(redisUtil.get("xywg:sjj:dispatch:"+deviceNo)!=null)
            {
                String str=sb.toString();
               str= str.substring(1,sb.length()-1);
                zbusProducerHolder.sendDispatchMessage(str);
            }
            LOGGER.info(sb.toString());
        } catch (Exception e) {
            e.printStackTrace();
        }

    }


    private void baojingshuju(String data, ChannelHandlerContext ctx) {
        if (!isLogin(ctx)) {
            throw new RuntimeException("未登录");
        }
        //获取内容
        String content = this.content(data);
        //采集时间 0-14
        Date collectTime = new Date();
        //跳过厂家及设备 14-16
        XySession xySession = ctx.channel().attr(NETTY_CHANNEL_KEY).get();
        String number = xySession.getNumber();
        String sn = xySession.getSn();
        String cj = xySession.getCj();
        StringBuffer sb = new StringBuffer("{")
                //采集时间
                .append("deviceNo:").append(sn(number, sn, cj)).append(",")
                .append("deviceTime:").append(collectTime.getTime()).append(",")
                .append("createTime:").append(collectTime.getTime()).append(",")
                //重量 12-16
                .append("weight:").append(toBigDecimal(Integer.parseInt(StrUtil.sub(content, 12, 16), 16), 0.001).toString()).append(",")
                //跳过 重量百分比16-18
                //人数 18-20
                .append("people:").append(toBigDecimal(Integer.parseInt(StrUtil.sub(content, 18, 20), 16), 1.0).toString()).append(",")
                //高度 20-24
                .append("height:").append(toBigDecimal(Integer.parseInt(StrUtil.sub(content, 20, 24), 16), 0.1).toString()).append(",");
        //跳过高度百分比 24-26
        //速度 26-28
        String suduStr = sudu(Integer.parseInt(StrUtil.sub(content, 26, 28), 16));
        String sudu = StrUtil.sub(suduStr, 0, 6);
        sb.append("speed:").append(toBigDecimal(Integer.parseInt(sudu, 2), 0.1)).append(",");
        // 倾角 28-32
        sb.append("tiltAngle:").append(qingjiao(Integer.parseInt(StrUtil.sub(content, 28, 32), 16))).append(",");
        // 跳过 倾斜度 32-40
        // 跳过 驾驶员 40-42
        // 门 42-44
        String menStr = men(Integer.parseInt(StrUtil.sub(content, 42, 44), 16));
        sb.append("frontDoorStatus:").append(StrUtil.sub(menStr, 1, 2)).append(",");
        sb.append("backDoorStatus:").append(StrUtil.sub(menStr, 0, 1)).append(",");
        sb.append(userinfo(ctx));
        sb.append("status:").append(alarm(StrUtil.sub(content, 44, 46), StrUtil.sub(content, 46, 48)))
                .append("}");

        try {
            zbusProducerHolder.sendSjjDataMessage(sb.toString());
            LOGGER.info(sb.toString());
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

    private String time(String hex) {
        StringBuffer sb = new StringBuffer();
        sb.append(2000 + Integer.parseInt(StrUtil.sub(hex, 0, 2), 16))
                .append(StrUtil.fillBefore(Integer.parseInt(StrUtil.sub(hex, 2, 4), 16) + "", '0', 2))
                .append(StrUtil.fillBefore(Integer.parseInt(StrUtil.sub(hex, 4, 6), 16) + "", '0', 2))
                .append(StrUtil.fillBefore(Integer.parseInt(StrUtil.sub(hex, 6, 8), 16) + "", '0', 2))
                .append(StrUtil.fillBefore(Integer.parseInt(StrUtil.sub(hex, 8, 10), 16) + "", '0', 2))
                .append(StrUtil.fillBefore(Integer.parseInt(StrUtil.sub(hex, 10, 12), 16) + "", '0', 2));
        return sb.toString();
    }

    private String men(Integer m) {
        return StrUtil.sub(StrUtil.fillBefore(Integer.toBinaryString(m), '0', 8), 6, 8);
    }

    /**
     * 倾角
     * |1500-x|
     *
     * @param q
     * @return
     */
    private String qingjiao(Integer q) {
        return toBigDecimal(1500, 0.01).subtract(toBigDecimal(q, 0.01)).abs().toString();
    }

    private String alarm(String content, String level) {
        int c = Integer.parseInt(content, 16);
        int l = Integer.parseInt(level, 16);
        if (l == 1) {
            //预警
            if (c == 1) {
                return "2";
            }
        }
        if (l == 2) {
            //报警
            if (c == 1) {
                return "1";
            }
            if (c == 3) {
                return "3";
            }

        }
        return "0";
    }

    private String alarm(String content) {
        String alarm = Integer.toBinaryString(Integer.parseInt(content, 16));
        alarm = StrUtil.fillAfter(alarm, '0', 16);
        // bit 0-1
        int zhongliang = Integer.parseInt(StrUtil.sub(alarm, 14, 16), 2);
        if (zhongliang == 1) {
            return "2";
        }
        if (zhongliang == 2) {
            return "1";
        }
        //bit 4-5
        int renshu = Integer.parseInt(StrUtil.sub(alarm, 10, 12), 2);
        if (renshu == 2) {
            return "3";
        }
        // bit 10
        int qianmen = Integer.parseInt(StrUtil.sub(alarm, 5, 6), 2);
        if (qianmen == 1) {
            return "4";
        }
        int houmen = Integer.parseInt(StrUtil.sub(alarm, 4, 5), 2);
        if (houmen == 1) {
            return "5";
        }
        // 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0
        return "0";
    }


    /**
     * @param source      数据
     * @param coefficient 系数
     * @return
     */
    private BigDecimal toBigDecimal(Integer source, Double coefficient) {
        BigDecimal b = new BigDecimal(source);
        b.setScale(3, BigDecimal.ROUND_HALF_UP);
        BigDecimal c = new BigDecimal(coefficient);
        c.setScale(3, BigDecimal.ROUND_HALF_UP);
        return b.multiply(c).setScale(3, BigDecimal.ROUND_HALF_UP);

    }

    private BigDecimal toBigDecimal(Integer source) {
        BigDecimal b = new BigDecimal(source);
        b.setScale(3, BigDecimal.ROUND_HALF_UP);
        return b;

    }

    /**
     * 比较校验码
     *
     * @param originalCheckCode 收到的数据原始校验码
     * @param data              原始字节
     * @return
     */
    private void equalsIgnoreCaseCheckCode(String originalCheckCode, String data) {
        byte[] datas = DataUtil.hexStringToBytes(data);
        String checkCodes = doCheckCode(DataUtil.subByteArray(datas, 0, datas.length - 6));
        //计算得到的校验位  累加和的低字节
        String checkCode = checkCodes.substring(checkCodes.length() - 2, checkCodes.length());
        if (!originalCheckCode.equalsIgnoreCase(checkCode)) {
            throw new RuntimeException("校验错误 <" + data + ">");
        }
    }

    /**
     * 字节累加和
     *
     * @param b
     * @return
     */
    private static String doCheckCode(byte[] b) {
        short s = 0;
        // 累加求和
        for (byte aB : b) {
            s += aB;
        }
        return DataUtil.byteToHex((byte) s);
    }

    /**
     * 截取校验码
     *
     * @param data
     * @return
     */
    private String checkCode(String data) {
        return StrUtil.sub(data, data.length() - 12, data.length() - 10);
    }

    /**
     * @param number
     * @param sn
     * @param cj
     * @return
     */
    public static String sn(String number, String sn, String cj) {
        return Integer.parseInt(sn, 16) + "";
    }

    public static String localKey(String type, String sn) {
        return type + ":" + sn;
    }

    /**
     * 合法性检查
     *
     * @param data
     * @return
     */
    private boolean valid(String data) {
        String up = data.toUpperCase();
        if (up.startsWith(HEADER) && up.endsWith(FOOTER)) {
            return true;
        }
        return false;
    }

    /**
     * 帧类型
     *
     * @param data
     * @return
     */
    private String type(String data) {
        return StrUtil.sub(data, 4, 6);
    }

    /**
     * 塔吊编号
     *
     * @param data
     * @return
     */
    private String number(String data) {
        return StrUtil.sub(data, 6, 8);
    }

    /**
     * @param data
     * @return
     */
    private String sn(String data) {
        return StrUtil.sub(data, 8, 14);
    }

    /**
     * 数据体
     *
     * @return
     */
    private String content(String data) {
        int length = data.length();
        return StrUtil.sub(data, 14, length - 12);
    }

    private String time() {
        Date now = new Date();
        StringBuffer sb = new StringBuffer();
        sb.append(Integer.toHexString(DateUtil.year(now) - 2000))
                .append(StrUtil.fillBefore(Integer.toHexString(DateUtil.month(now)+1), '0', 2))
                .append(StrUtil.fillBefore(Integer.toHexString(DateUtil.dayOfMonth(now)), '0', 2))
                .append(StrUtil.fillBefore(Integer.toHexString(DateUtil.hour(now, true)), '0', 2))
                .append(StrUtil.fillBefore(Integer.toHexString(DateUtil.minute(now)), '0', 2))
                .append(StrUtil.fillBefore(Integer.toHexString(DateUtil.second(now)), '0', 2));
        return sb.toString();
    }

    @Override
    public void channelActive(ChannelHandlerContext ctx) throws Exception {

        LOGGER.info("###########有设备连接处理器############");
    }

    @Override
    public void userEventTriggered(ChannelHandlerContext ctx, Object evt) throws Exception {

        if (evt instanceof IdleStateEvent) {
            IdleStateEvent event = (IdleStateEvent) evt;
            if (event.state() == IdleState.READER_IDLE) {
                LOGGER.info("###客户端闲置，服务器主动关闭连接###");
                ctx.close();
            }
        }
    }

    private boolean isLogin(ChannelHandlerContext ctx) {
        XySession sn = ctx.channel().attr(NETTY_CHANNEL_KEY).get();
        return sn != null;
    }

    @Override
    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) {
        cause.printStackTrace();
        LOGGER.error("异常[{}]", cause.getMessage());
        if (!isLogin(ctx)) {
            ctx.close();
        }

    }

    @Override
    public void channelInactive(ChannelHandlerContext ctx) throws Exception {
        LOGGER.info("###########有设备断开处理器############");
        //获取当前通道session
        XySession currSession = ctx.channel().attr(NETTY_CHANNEL_KEY).get();
        if (currSession == null) {
            return;
        }
        String localkey = localKey(currSession.getType(), sn(currSession.getNumber(), currSession.getSn(), currSession.getCj()));
        //获取本地缓存中的通道session
        XySession localSession = nettyChannels.get(localkey).attr(NETTY_CHANNEL_KEY).get();
        if (currSession.equals(localSession)) {
            //表示本地与当前是同一个副本
            nettyChannels.remove(localkey);
            //修改数据库 内设备状态为离线，不管是否操作成功
            try {
                zbusProducerHolder.sendSjjLxMessage(localkey);
            } catch (Exception ex) {
                LOGGER.error(ex.getMessage());
            }
            LOGGER.info("删除本地通道及redis缓存");
        } else {
            //本地与当前不是同一个副本
            //可能由于设备异常掉线，并重新上线造成
            LOGGER.info("通道副本已被更新");
        }

    }

    private static String sudu(Integer integer) {
        String bin = Integer.toBinaryString(integer);

        if (bin.length() > 8) {
            bin = StrUtil.sub(bin, 0, 8);
        } else {
            bin = StrUtil.fillBefore(bin, '0', 8);
        }
        return bin;
    }

    /**
     * 发送测试
     *
     * @param data
     */
    private void sendTest(String data) {
        String number = this.number(data);
        String sn = this.sn(data);
        String cj = this.content(data);
        try {
            zbusProducerHolder.sendTestMessage(sn(number, sn, cj), data);
        } catch (Exception e) {
            e.printStackTrace();

        }
    }


    public static void main(String[] args) throws IOException {

        String bin = Integer.toBinaryString(33);
        bin = StrUtil.fillBefore(bin, '0', 8);
        System.out.println(bin);
        System.out.println(Integer.parseInt(bin.substring(0, 6), 2));
//        InputStream is = null;
//        try {
//            is = new FileInputStream("D:/aaa.txt");
//        } catch (FileNotFoundException e) {
//            e.printStackTrace();
//        }
//        InputStreamReader isr = new InputStreamReader(is);
//        BufferedReader br = new BufferedReader(isr);
//        String str = null;
//        StringBuilder sb = new StringBuilder();
//        while ((str = br.readLine()) != null)
//        {
//            System.out.println(str);
//            sb.append(str);
//        }
//        saveToImgFile(sb.toString().toUpperCase(), "D:/bbb.jpeg");

    }
}
